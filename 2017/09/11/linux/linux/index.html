<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|consolas:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="linux," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="关闭防火墙12345678# 查看防火墙状态service iptables status# 查看已经开启的端口/etc/init.d/iptables status # 开启chkconfig iptables on# 关闭chkconfig iptables off  目录操作12345678# 创建目录mkdir a# -p参数，递归创建mkdir -p a/b/c# 删除目录，要求目录必须">
<meta name="keywords" content="linux">
<meta property="og:type" content="article">
<meta property="og:title" content="linux">
<meta property="og:url" content="http://xxyxpy.pub/2017/09/11/linux/linux/index.html">
<meta property="og:site_name" content="code dog">
<meta property="og:description" content="关闭防火墙12345678# 查看防火墙状态service iptables status# 查看已经开启的端口/etc/init.d/iptables status # 开启chkconfig iptables on# 关闭chkconfig iptables off  目录操作12345678# 创建目录mkdir a# -p参数，递归创建mkdir -p a/b/c# 删除目录，要求目录必须">
<meta property="og:updated_time" content="2017-10-13T02:14:24.120Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="linux">
<meta name="twitter:description" content="关闭防火墙12345678# 查看防火墙状态service iptables status# 查看已经开启的端口/etc/init.d/iptables status # 开启chkconfig iptables on# 关闭chkconfig iptables off  目录操作12345678# 创建目录mkdir a# -p参数，递归创建mkdir -p a/b/c# 删除目录，要求目录必须">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://xxyxpy.pub/2017/09/11/linux/linux/"/>





  <title> linux | code dog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?280f588c4cdeeff61afc14b4a4f44814";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">code dog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">不停奔跑，不停思考~</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://xxyxpy.pub/2017/09/11/linux/linux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xxyxpy">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="code dog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                linux
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-11T12:14:48+08:00">
                2017-09-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/09/11/linux/linux/" class="leancloud_visitors" data-flag-title="linux">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 查看防火墙状态</div><div class="line">service iptables status</div><div class="line"># 查看已经开启的端口</div><div class="line">/etc/init.d/iptables status </div><div class="line"># 开启</div><div class="line">chkconfig iptables on</div><div class="line"># 关闭</div><div class="line">chkconfig iptables off</div></pre></td></tr></table></figure>
<hr>
<h4 id="目录操作"><a href="#目录操作" class="headerlink" title="目录操作"></a>目录操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 创建目录</div><div class="line">mkdir a</div><div class="line"># -p参数，递归创建</div><div class="line">mkdir -p a/b/c</div><div class="line"># 删除目录，要求目录必须为空</div><div class="line">rmdir -p a/b/c</div><div class="line"># 删除带有数据的目录，r删除目录 f强制删除</div><div class="line">rm -rf c</div></pre></td></tr></table></figure>
<h4 id="拷贝"><a href="#拷贝" class="headerlink" title="拷贝"></a>拷贝</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cp test1.txt test2.txt</div><div class="line"># 拷贝目录需要添加 -r</div><div class="line">cp -r a/ b</div></pre></td></tr></table></figure>
<h4 id="移动文件或目录"><a href="#移动文件或目录" class="headerlink" title="移动文件或目录"></a>移动文件或目录</h4><p>可用来重命名文件或目录。不需要加-r</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mv apache-tomcat-8.0.44/  /usr/local/application/solr/tomcat-solr</div></pre></td></tr></table></figure>
<p>生成和写入文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># 有此文件时更新时间，没有时生成</div><div class="line">touch 1.txt</div><div class="line"># 写入数据到指定的文件</div><div class="line">echo &quot;abc&quot; &gt; 2.txt</div><div class="line"># 读取文件内容显示</div><div class="line">cat 2.txt</div></pre></td></tr></table></figure>
<hr>
<h4 id="权限操作"><a href="#权限操作" class="headerlink" title="权限操作"></a>权限操作</h4><p>权限分为x运行，w写入和r读取值分别为4，2，1。</p>
<p>chmod 语法： chmod [-R] xyz 文件名（这里的xyz，表示数字）</p>
<p>-R选项只作用于目录，作用是级联更改，即不仅更改当前目录，连目录里的目录或者文件全部更改</p>
<p>如果你创建了一个目录，而该目录不想让其他人看到内容，则只需设置成 rwxr—– (740) 即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"># 如果想设置全部的权限即rwx(4+2+1),设置权限值为777</div><div class="line"># b目录以及其所有的子目录和文件权限全部为rwxrwxrwx</div><div class="line">chmod -R 777 b</div><div class="line"># 可以使用r w x方式单独设置权限，使用前需要清楚以下内容</div><div class="line"># 分类user使用u表示，代表用户（前三位）；group使用g表示代表所属组（中间三位）；</div><div class="line"># other使用o表示代表其它组（最后三位）；all使用a表示以上三个（9位）</div><div class="line"># + 加入权限 - 减少权限 = 设置等于此权限</div><div class="line"># 例1：1.txt文件og添加w的权限</div><div class="line">chmod og+w 1.txt</div><div class="line"># 例2：b目录所有去掉r权限，使用a或为空表示所有</div><div class="line">chmod -r b</div><div class="line"># 例3：设置多个使用,隔开</div><div class="line">chmod u=rwx,og=rx 2.txt</div></pre></td></tr></table></figure>
<h4 id="文件查找-find"><a href="#文件查找-find" class="headerlink" title="文件查找 find"></a>文件查找 find</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># -name filename 直接查找该文件名的文件</div><div class="line">find -name temp</div><div class="line"># -type type 通过文件类型查找，文件类型有f(文件)，d（目录）,b,c,l(连接档类似于windows下的快捷方式),s</div><div class="line">find -type d</div></pre></td></tr></table></figure>
<h4 id="切换用户"><a href="#切换用户" class="headerlink" title="切换用户"></a>切换用户</h4><p> su [-] username</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">su -</div><div class="line"># 打印当前登录的用户</div><div class="line">echo $LOGNAME</div></pre></td></tr></table></figure>
<h4 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">passwd [username]</div></pre></td></tr></table></figure>
<h4 id="磁盘管理"><a href="#磁盘管理" class="headerlink" title="磁盘管理"></a>磁盘管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 查看磁盘使用情况</div><div class="line">df -h</div><div class="line"># 查看占用空间大小 du [-abckmsh] [文件或者目录名] a全部列出 c最后加总 h自动调节单位</div><div class="line">du -h nginx-1.8.0.tar.gz</div></pre></td></tr></table></figure>
<h4 id="开启关闭指定端口"><a href="#开启关闭指定端口" class="headerlink" title="开启关闭指定端口"></a>开启关闭指定端口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># 打开</div><div class="line">/sbin/iptables -I INPUT -p tcp --dport 3306 -j ACCEPT</div><div class="line"># 关闭</div><div class="line">/sbin/iptables -I INPUT -p tcp --dport 80 -j DROP</div><div class="line">/etc/rc.d/init.d/iptables save</div><div class="line"># 重启服务</div><div class="line">/etc/rc.d/init.d/iptables restart</div><div class="line"># 查看端口是否已开放</div><div class="line">/etc/init.d/iptables status</div></pre></td></tr></table></figure>
<h4 id="查看tomcat的启动信息"><a href="#查看tomcat的启动信息" class="headerlink" title="查看tomcat的启动信息"></a>查看tomcat的启动信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tail -f logs/catalina.out</div></pre></td></tr></table></figure>
<p>拷贝目录。可以同时指定新目录名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 拷贝solr目录下的所有内容到solrhome下</div><div class="line">cp -r solr/ /usr/local/application/solr/solrhome</div></pre></td></tr></table></figure>
<h4 id="编辑工具vim使用"><a href="#编辑工具vim使用" class="headerlink" title="编辑工具vim使用"></a>编辑工具vim使用</h4><p>一般模式：默认打开文件时。可以进行上下移动光标；删除某个字符；删除某行；复制、粘贴一行或者多行。此模式下可以使用</p>
<p>编辑模式：可以用i（在当前字符前插入字符）I（在当前行首插入字符）a（在当前字符后插入字符）A（在当前行末插入字符）o（在当前行下插入新的一行）O（在当前行上插入新的一行）。进入编辑模式时，会在屏幕的最下一行出现“INSERT或REPLACE”的字样。从编辑模式回到一般模式只需要按一下键盘左上方的ESC键即可</p>
<p>命令模式：在一般模式下，输入”:”或者”/”即可进入命令模式。在该模式下，你可以搜索某个字符或者字符<br>串，也可以保存、替换、退出、显示行号等等</p>
<p>:w 将编辑过的文档保存。</p>
<p>:w! 若文本属性为只读时强制保存</p>
<p>:q 退出vim :q! 不管编辑或未编辑都不保存退出</p>
<p>:wq 保存并退出</p>
<p>:set nu 在行首显示行号 :set nonu 取消行号</p>
<p>翻前页：ctrl+f或pageup</p>
<p>翻后页：ctrl+b或pagedown</p>
<p>查找：/word 查找到光标之后的word字符串，n可以继续查找下一个，N可以查找上一个。?word可以查找到光标之前的word字符串</p>
<h4 id="压缩与打包"><a href="#压缩与打包" class="headerlink" title="压缩与打包"></a>压缩与打包</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"># 压缩文件gzip [-d#] filename 其中#为1-9的数字。不可以压缩目录</div><div class="line"># -d ：解压缩时使用</div><div class="line"># -# ：压缩等级，1压缩最差，9压缩最好，6为默认</div><div class="line">gzip schema.xml</div><div class="line"># 解压</div><div class="line">gzip -d schema.xml.gz</div><div class="line">########### tar #############</div><div class="line"># tar [-zjxcvfpP] filename</div><div class="line"># -z ：是否同时用gzip压缩</div><div class="line"># -j ：是否同时用bzip2压缩</div><div class="line"># -x ：解包或者解压缩</div><div class="line"># -t ：查看tar包里面的文件</div><div class="line"># -c ：建立一个tar包或者压缩文件包</div><div class="line"># -v ：可视化</div><div class="line"># -f ：后面跟文件名，压缩时跟-f文件名，意思是压缩后的文件名为filename，解压时跟-f文件名，</div><div class="line"># 意思是解压filename。请注意，如果是多个参数组合的情况下带有-f，请把f写到最后面。</div><div class="line"># -p ：使用原文件的属性，压缩前什么属性压缩后还什么属性。（不常用）</div><div class="line"># -P ：可以使用绝对路径。（不常用）</div><div class="line"># --exclude filename ：在打包或者压缩时，不要将filename文件包括在内。（不常用）</div><div class="line"></div><div class="line"># 压缩 b目录-&gt;b.tar</div><div class="line">tar -cvf b.tar b</div><div class="line"># 解压</div><div class="line">tar -xvf b.tar </div><div class="line"># 打包同时使用gzip压缩</div><div class="line">tar -zcvf b.tar.gz b </div><div class="line"># 只查看压缩包内的内容，不解压</div><div class="line">tar -tf b.tar.gz</div></pre></td></tr></table></figure>
<h4 id="yum配置"><a href="#yum配置" class="headerlink" title="yum配置"></a>yum配置</h4><p>CentOS则你可以从/etc/yum.repos.d/CentOS-Base.repo这个文件下看到相关的配置信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># 搜索包</div><div class="line">yum search vim</div><div class="line">yum list |grep vim</div><div class="line"># 安装一个rpm包 yum install [-y] [rpm包名] -y选项，会以与用户交互的方式安装</div><div class="line"># 卸载一个rpm包 “yum remove [-y] [rpm包名]”</div><div class="line"># 升级一个rpm包 “yum update [-y] [rpm包]”</div></pre></td></tr></table></figure>
<h4 id="安装源码包"><a href="#安装源码包" class="headerlink" title="安装源码包"></a>安装源码包</h4><p>三个步骤</p>
<ol>
<li>./config 在这一步可以定制功能，加上相应的选项即可，具有有什么选项可以通过”./config –help ”命令来<br>查看。在这一步会自动检测你的linux系统与相关的套件是否有编译该源码包时需要的库，因为一旦缺少某个库就<br>不能完成编译。只有检测通过后才会生成一个Makefile文件。</li>
<li>make 使用这个命令会根据Makefile文件（必须要有此文件）中预设的参数进行编译，这一步其实就是gcc在工作了。</li>
<li>make install 安装步骤，生成相关的软件存放目录和配置文件的过程</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># 下载安装tomcat</div><div class="line"># 1 下载源码包</div><div class="line">wget http://apache.mirrors.ionfish.org/tomcat/tomcat-8/v8.0.46/bin/apache-tomcat-8.0.46.tar.gz</div><div class="line"># 2 解压源码包</div><div class="line"></div><div class="line"># 3 配置相关选项，生成makefile</div><div class="line"></div><div class="line"># 4 编译</div><div class="line"></div><div class="line"># 5 安装</div></pre></td></tr></table></figure>
<h4 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"># 1 历史命令。!!执行上一条 !n 执行命令历史中第n条指令 !字符串（字符串大于等于1），例如!ta，表示执行命令	# 历史中最近一次以ta为开头的指令</div><div class="line"># 2 指令和文件名补全 按tab键，它可以帮你补全一个指令，也可以帮你补</div><div class="line">	# 全一个路径或者一个文件名。连续按两次tab键，系统则会把所有的指令或者文件名都列出来</div><div class="line"># 3 别名。alias显示所有的别名</div><div class="line"># 4 通配符，使用*来匹配零个或多个字符，而用?匹配一个字符</div><div class="line">ls -d test*</div><div class="line"># 5 输入输出重定向。输出重定向&gt;，追加重定向&gt;&gt;</div><div class="line"># 6 管道|，就是把前面的命令运行的结果丢给后面的命令</div><div class="line"># 7 作业控制。当运行一个进程时，你可以使它暂停（按Ctrl+z），然后使用fg命令恢复它，利用bg命令使他到后台运</div><div class="line">	# 行，你也可以使它终止（按Ctrl+c）</div><div class="line"></div><div class="line"># 查看环境变量PATH等信息</div><div class="line">echo $PATH</div><div class="line">echo $PWD</div><div class="line">echo $HOME</div><div class="line">echo $LOGNAME</div><div class="line"># 查看所有的预设环境变量</div><div class="line">env</div><div class="line">set</div><div class="line"># 用户自定义变量，只在当前的shell中生效。使用bash命令即可再打开一个shell</div><div class="line">myname=Aming</div><div class="line">echo $myname</div><div class="line"># 1 如果想系统内所有用户登录后都能使用该变量。需要在/etc/profile文件最末行加入 “export myname=Aming” </div><div class="line">	# 然后运行”source /etc/profile”就可以生效了。此时你再运行bash命令或者直接su - test账户看看</div><div class="line"># 2 只想让当前用户使用该变量。需要在用户主目录下的.bashrc文件最后一行加入“export myname=Aming”</div><div class="line">然后运行”source .bashrc”就可以生效了。这时候再登录test账户，myname变量则不会生效了。</div><div class="line">上面用的source命令的作用是，讲目前设定的配置刷新，即不用注销再登录也能生效</div><div class="line">	</div><div class="line"># pstree 把linux系统中所有进程通过树形结构打印出来</div><div class="line">pstree |grep bash</div><div class="line"># export 指令父shell中设定一个变量后，进入子shell后该变量是不会生效的，</div><div class="line">	# 如果想让这个变量在子shell中生效则要用到export指令。export其实就是声明一下这个变量的意思，</div><div class="line">	# 让该shell的子shell也知道变量abc的值是123.如果export后面不加任何变量名，则它会声明所有的变量。</div><div class="line"># 取消一个设置的变量</div><div class="line">abc=123</div><div class="line">echo $abc</div><div class="line">unset abc</div></pre></td></tr></table></figure>
<h4 id="系统环境变量与个人环境变量的配置文件"><a href="#系统环境变量与个人环境变量的配置文件" class="headerlink" title="系统环境变量与个人环境变量的配置文件"></a>系统环境变量与个人环境变量的配置文件</h4><p>系统级别：</p>
<p>/etc/profile：这个文件预设了几个重要的变量，例如PATH, USER, LOGNAME, MAIL…</p>
<p>/etc/bashrc ：这个文件主要预设umask以及PS1。这个PS1就是我们在敲命令时，前面那串字符了</p>
<p>用户级别（在用户目录下）：</p>
<p>.bash_profile：定义了用户的个人化路径与环境变量的文件名称。每个用户都可使用该文件输入专用于自己使用<br>的shell信息,当用户登录时,该文件仅仅执行一次</p>
<p>.bashrc：该文件包含专用于你的shell的bash信息,当登录时以及每次打开新的shell时,该该文件被读取。例如你<br>可以将用户自定义的alias或者自定义变量写到这个文件中。</p>
<p>.bash_history：记录命令历史用的。</p>
<p>.bash_logout ：当退出shell时，会执行该文件。可以把一些清理的工作放到这个文件中。</p>
<h4 id="shell中的特殊符号"><a href="#shell中的特殊符号" class="headerlink" title="shell中的特殊符号"></a>shell中的特殊符号</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"># 1 * 代表0个或多个字符或数字</div><div class="line">ls -d test*</div><div class="line"># 2 ? 代表一个任意字符</div><div class="line">touch testa testb testc</div><div class="line">ls -d test?</div><div class="line"># 3 # 代表注释的意思</div><div class="line"># 4 \ 转入字符，将特殊符号进行转入</div><div class="line">ls test\*</div><div class="line"># 5 | 管道符。用于将特号前面执行的结果丢给符号后面的命令</div><div class="line"># 6 $ 一种方式是作为变量前的标识符，另外和！结合起来使用 !$ 表示上条命令中最后一个变量</div><div class="line">ls testa # show testa</div><div class="line">ls !$ # show ls testa  testa</div></pre></td></tr></table></figure>
<h4 id="shell中管道命令"><a href="#shell中管道命令" class="headerlink" title="shell中管道命令"></a>shell中管道命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"># 1 grep 过滤一个或多个字符</div><div class="line">cat /etc/passwd |grep root</div><div class="line"># 2 cut：截取某一个字段 语法：cut -d “分隔字符” [-cf] n 这里的n是数字</div><div class="line">	# -d ：后面跟分隔字符，分隔字符要用双引号括起来</div><div class="line">	# -c ：后面接的是第几个字符</div><div class="line">	# -f ：后面接的是第几个区块</div><div class="line">cat /etc/passwd |cut -d &quot;:&quot; -f 1</div><div class="line"># 3 sort 用做排序 语法：sort [-t 分隔符] [-kn1,n2] [-nru] 这里的n1 &lt; n2</div><div class="line">	# -t 分隔符：作用跟cut的-d一个意思</div><div class="line">	# 第 12 章 学习 shell 脚本之前的基础知识 | 151</div><div class="line">	# -n ：使用纯数字排序</div><div class="line">	# -r ：反向排序</div><div class="line">	# -u ：去重复</div><div class="line">	# -kn1,n2 ：由n1区间排序到n2区间，可以只写-kn1，即对n1字段排序</div><div class="line">head -n5 /etc/passwd |sort -t: -k3n</div><div class="line"># 4 wc：统计文档的行数、字符数、词数，常用的选项为：</div><div class="line">	# -l ：统计行数</div><div class="line">	# -m ：统计字符数</div><div class="line">	# -w ：统计词数</div><div class="line">cat 1.txt |wc -l</div><div class="line">cat 1.txt |wc -m</div><div class="line">cat 1.txt |wc -w</div><div class="line"># 5 uniq：去重复的行 在进行uniq之前，需要先用sort排序然后才能uniq，否则你将得不到你想要的</div><div class="line">	# -c ：统计重复的行数，并把行数写在前面</div><div class="line">cat 1.txt |uniq</div><div class="line">cat 1.txt |uniq -c</div><div class="line"># 6 tee ：后跟文件名，类似与重定向”&gt;”，但是比重定向多了一个功能，在把文件写入后面所跟的文件中的同</div><div class="line">	# 时，还显示在屏幕上。</div><div class="line">echo &quot;haha&quot; |tee 1.txt</div><div class="line"># 7 tr 替换字符-d ：删除某个字符，-d 后面跟要删除的字符 -s ：把重复的字符去掉</div><div class="line"># 小写转大写</div><div class="line">cat 1.txt |tr &apos;[a-z]&apos; &apos;[A-Z]&apos;</div><div class="line"># 单个字符替换</div><div class="line">cat 1.txt |grep a |tr &apos;d&apos; &apos;D&apos;</div><div class="line"># 8 split ：切割文档，常用选项：</div><div class="line">	# -b ：依据大小来分割文档，单位为byte</div><div class="line">	# -l ：依据行数来分割文档</div><div class="line">split -b 500 3.txt my</div><div class="line">split -l 1 1.txt your</div><div class="line"># 9 分号：平时我们都是在一行中敲一个命令，然后回车就运行了，那么想在一行中运行两个或两个以上的命</div><div class="line">	# 令如何呢？则需要在命令之间加一个”;”了</div><div class="line">ls -d test*;touch test5;ls -d test*	</div><div class="line"># 10 &amp; ：如果想把一条命令放到后台执行的话，则需要加上这个符号。通常用于命令运行时间非常长的情况</div><div class="line">sleep 100 &amp;</div><div class="line"># 查看后台任务jobs可以查看当前shell中后台执行的任务。用fg可以调到前台执行。</div><div class="line"># 这里的sleep命令就是休眠的意思，后面跟数字，单位为秒，常用语循环的shell脚本中</div><div class="line"># 此时你按一下CTRL +z 使之暂停，然后再输入bg可以再次进入后台执行</div><div class="line"># 如果是多任务情况下，想要把任务调到前台执行的话，fg后面跟任务号，任务号可以使用jobs命令得到</div><div class="line">jobs</div><div class="line"># 11   &gt;, &gt;&gt;, 2&gt;, 2&gt;&gt;：前面讲过重定向符号&gt; 以及&gt;&gt;　分别表示取代和追加的意思，</div><div class="line"># 然后还有两个符号就是这里的2&gt; 和 2&gt;&gt;　分别表示错误重定向和错误追加重定向，当我们运行一个命令报错时，</div><div class="line"># 报错信息会输出到当前的屏幕，如果想重定向到一个文本里，则要用2&gt;或者2&gt;&gt;</div><div class="line"># 12  [ ]：中括号，中间为字符组合，代表中间字符中的任意一个</div><div class="line">ll test[a-c]</div><div class="line"># 12 &amp;&amp; || 两条命令时类似于java中的判断</div><div class="line">ls testa &amp;&amp; touch test11</div></pre></td></tr></table></figure>
<hr>
<h4 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h4><p>grep 语法： grep [-cinvABC] ‘word’ filename</p>
<p>-c ：打印符合要求的行数<br>-i ：忽略大小写<br>-n ：在输出符合要求的行的同时连同行号一起输出<br>-v ：打印不符合要求的行<br>-A ：后跟一个数字（有无空格都可以），例如 –A2则表示打印符合要求的行以及下面两行<br>-B ：后跟一个数字，例如 –B2 则表示打印符合要求的行以及上面两行<br>-C ：后跟一个数字，例如 –C2 则表示打印符合要求的行以及上下各两行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"># 过滤出带有某个关键词的行并输出行号</div><div class="line">grep -n &apos;root&apos; /etc/passwd</div><div class="line"># 过滤不带有某个关键词的行，并输出行号</div><div class="line">grep -vn &quot;nologin&quot; /etc/passwd</div><div class="line"># 过滤出所有包含数字的行 如果要过滤出数字以及大小写字母则要这样写[0-9a-zA-Z]</div><div class="line">grep [0-9] 123.txt</div><div class="line"># 以某个字段开头或以某个字段结尾的行。^ 开头 $ 结尾 grep -v ‘^$’ filename表示非空行</div><div class="line">grep &apos;^a&apos; 1.txt</div><div class="line">grep &apos;a$&apos; 1.txt</div><div class="line"># 过滤任意一个字符与重复字符 . 表示任意一个字符，* 表示0个或多个字符</div><div class="line">grep &apos;a..d&apos; 1.txt</div><div class="line">grep &apos;a*&apos; 1.txt</div><div class="line"># 指定要过滤字符出现的次数</div><div class="line">grep &apos;c\&#123;1\&#125;&apos; 1.txt</div></pre></td></tr></table></figure>
<hr>
<h4 id="查看程序的端口占用情况"><a href="#查看程序的端口占用情况" class="headerlink" title="查看程序的端口占用情况"></a>查看程序的端口占用情况</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"># 查看tomcat端口占用</div><div class="line">ps -aux | grep tomcat</div><div class="line"># 查看所有的进程和端口使用情况 其中最后一栏是PID/Program name </div><div class="line">netstat –apn</div><div class="line"># 根据结果中的PID查看是哪个程序在占用。发现8080端口被PID为9658的Java进程占用。</div><div class="line"># 进一步使用命令：ps -aux | grep java，或者直接：ps -aux | grep pid 查看</div><div class="line"># 找到后使用KILL命令结束掉</div><div class="line">ps -aux | grep java</div><div class="line">ps -aux | grep pid </div><div class="line"># 方法二：直接使用 netstat   -anp   |   grep  portno</div><div class="line"># 即：netstat –apn | grep 8080</div><div class="line"></div><div class="line"># centos中</div><div class="line"># 比如查看80端口占用情况</div><div class="line">lsof -i tcp:80</div><div class="line"># 列出所有端口</div><div class="line">netstat -ntlp</div></pre></td></tr></table></figure>
<hr>
<h4 id="shell脚本"><a href="#shell脚本" class="headerlink" title="shell脚本"></a>shell脚本</h4><p>凡是自定义的脚本建议放到/usr/local/sbin/目录下</p>
<p>test.sh中第一行一定是 “#! /bin/bash”它代表的意思是，该文件使用的是bash语法</p>
<p>默认我们用vim编辑的文档是不带有执行权限的，所以需要加一个执行权限</p>
<p>使用sh命令去执行一个shell脚本的时候是可以加-x选项来查看这个脚本执行过程的 sh -x test.sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># date 格式化日期 W表示星期</div><div class="line">date &quot;+%Y%m%d %H:%M:%S&quot; </div><div class="line"># 天数加减</div><div class="line">date -d &quot;-1 day&quot; &quot;+%Y%m%d&quot;</div></pre></td></tr></table></figure>
<p>在shell中使用变量</p>
<p>反引号表示执行里面的内容。变量的引用要用$开头后面跟上变量名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line"></div><div class="line">d=`date +%H:%M:%S`</div><div class="line">echo &quot;the script begin at $d&quot;</div><div class="line">echo &quot;now we will sleep 2 seconds.&quot;</div><div class="line">sleep 2</div><div class="line">d1=`date +%H:%M:%S`</div><div class="line">echo &quot;the script end at $d1</div></pre></td></tr></table></figure>
<p>数学计算要用[]括起来并且以$开头</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">a=1</div><div class="line">b=2</div><div class="line">sum=$[$a+$b]</div><div class="line"></div><div class="line">echo &quot;sum is $sum&quot;</div></pre></td></tr></table></figure>
<p>和用户交互，提供输入功能.read表示需要用户通过键盘进行输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">echo &quot;Please input a number:&quot;</div><div class="line">read x</div><div class="line">echo &quot;Please input another number:&quot;</div><div class="line">read y</div><div class="line">sum=$[$x+$y]</div><div class="line">echo &quot;The sum of tow number is:$sum.&quot;</div></pre></td></tr></table></figure>
<p>另外一种更为简单的方式。read -p选项类似于echo的作用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">read -p &quot;Please input a number:&quot; x</div><div class="line">read -p &quot;Please input another number:&quot; y</div><div class="line">sum=$[$x+$y]</div><div class="line">echo &quot;The sum of tow number is:$sum.&quot;</div></pre></td></tr></table></figure>
<p>shell脚本的预设变量，例如/etc/init.d/iptables restart </p>
<p>以下脚本执行 sh -x test6.sh 1 2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">sum=$[$1+$2]</div><div class="line">echo $sum</div><div class="line">echo $0 $1 $2</div></pre></td></tr></table></figure>
<p>shell脚本中的逻辑判断</p>
<p>不带else. ((a&lt;60))这样的形式，这是shell脚本中特有的格式，用一个小括号或者不用都会报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">read -p &quot;Please input your score:&quot; a</div><div class="line">if ((a&lt;60)); then</div><div class="line">	echo &quot;You didn&apos;t pass the exam.&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>带else</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">read -p &quot;Please input your score:&quot; a</div><div class="line">if ((a&lt;60)); then</div><div class="line">	echo &quot;You didn&apos;t pass the exam.&quot;</div><div class="line">else</div><div class="line">	echo &quot;Good! You pass the exam.&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>带elif的多重判断   &amp;&amp; 表示“并且”的意思，当然你也可以使用 || 表示“或者”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">read -p &quot;Please input your score:&quot; a</div><div class="line">if ((a&lt;60)); then</div><div class="line">	echo &quot;You didn&apos;t pass the exam.&quot;</div><div class="line">elif ((a&gt;60)) &amp;&amp; ((a&lt;85)); then</div><div class="line">	echo &quot;Good! You pass the exam.&quot;</div><div class="line">else</div><div class="line">	echo &quot;Very Good! Your Score is very high.&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>在判断数值大小除了可以用”(( ))”的形式外，还可以使用”[ ]”。但是就<br>不能使用&gt;, &lt; , = 这样的符号了，要使用 -lt （小于），-gt （大于），-le （小于等于），-ge （大于等<br>于），-eq （等于），-ne （不等于）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a=10;if [ $a -lt 5 ]; then echo ok;fi</div><div class="line">a=10;if [ $a -gt 5 ]; then echo ok;fi</div></pre></td></tr></table></figure>
<p>shell 脚本中if还经常判断关于档案属性，比如判断是普通文件还是目录，判断文件是否有读写执行权限等</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">-e ：判断文件或目录是否存在</div><div class="line">-d ：判断是不是目录，并是否存在</div><div class="line">-f ：判断是否是普通文件，并存在</div><div class="line">-r ：判断文档是否有读权限</div><div class="line">-w ：判断是否有写权限</div><div class="line">-x ：判断是否可执行</div><div class="line">if [ -d /home ] ; then echo ok; fi</div><div class="line">if [ -f /home ] ; then echo ok; fi</div></pre></td></tr></table></figure>
<p>shell脚本中使用case</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">case 变量 in</div><div class="line">value1)</div><div class="line">command</div><div class="line">;;</div><div class="line">value2)</div><div class="line">command</div><div class="line">;;</div><div class="line">value3)</div><div class="line">command</div><div class="line">;;</div><div class="line">*)</div><div class="line">command</div><div class="line">;;</div><div class="line">esac</div><div class="line"></div><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">read -p &quot;Please input a number:&quot; n</div><div class="line">a=$[$n%2]</div><div class="line">case $a in </div><div class="line">1)</div><div class="line">	echo &quot;The number is odd&quot;</div><div class="line">	;;</div><div class="line">0)</div><div class="line">	echo &quot;The number is even&quot;</div><div class="line">esac</div></pre></td></tr></table></figure>
<p>shell脚本中使用for while循环</p>
<p>seq 1 5 表示从1到5的一个序列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">for 变量名 in 循环的条件； do</div><div class="line">command</div><div class="line">done</div><div class="line"></div><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">for i in `seq 1 5`; do</div><div class="line">	echo $i</div><div class="line">done</div><div class="line"></div><div class="line"># 循环的条件那一部分也可以写成这样的形式，中间用空格隔开即可</div><div class="line">for i in 1 2 3 4 5; do echo $i; done</div><div class="line"></div><div class="line">while 条件; do</div><div class="line">command</div><div class="line">done</div><div class="line"></div><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">a=10</div><div class="line">while [ $a -ge 1 ]; do</div><div class="line">	echo &quot;$a&quot;</div><div class="line">	a=$[$a-1]</div><div class="line">done</div><div class="line"></div><div class="line"># 忽略掉while中的条件 </div><div class="line">while :; do</div><div class="line">command</div><div class="line">done</div></pre></td></tr></table></figure>
<p>shell脚本中的函数</p>
<p>shell脚本中，函数一定要写在最前面，不能出现在中间或者最后</p>
<p>function 函数名() {<br>command<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line">function sum()&#123;</div><div class="line">  sum=$[$1+$2]</div><div class="line">  echo $sum</div><div class="line">&#125;</div><div class="line"></div><div class="line">sum $1 $2</div></pre></td></tr></table></figure>
<hr>
<h4 id="日常管理"><a href="#日常管理" class="headerlink" title="日常管理"></a>日常管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">w  查看当前系统的负载</div><div class="line">vmstat  监控系统的状态</div><div class="line">top 显示进程所占系统资源</div><div class="line">sar -n DEV 查看网卡流量 </div><div class="line">sar -q 查看历史负载 </div><div class="line">free 查看内存使用状况</div><div class="line">ps aux 查看系统进程 进程id可以用 kill pid杀掉。杀不掉的可以使用 kill -9 pid</div><div class="line">	可以用ps aux |grep redis进行筛选</div><div class="line">netstat  查看网络状况 netstat -lnp（打印当前系统启动哪些端口）以及netstat -an （打印网络连接状况）</div><div class="line">tcpdump  抓包工具 yum install -y tcpdump 命令去安装一下</div><div class="line">ifconfig  查看网卡ip 设置IP非常简单修改配置文件/etc/sysconfig/networ</div><div class="line">k-scripts/ifcfg-eth0了，如果是eth1那么配置文件是/etc/sysconfig/network-scripts/ifcfg-eth1.如果你的linux是通过dhcp服务器自动获得的IP，BOOTPROTO那里会是’dhcp’，如果你要配置成静</div><div class="line">	态IP的话，这里就需要写成’none’当修改完IP后需要重启网络服务新IP才能生效，重</div><div class="line">	启命令为’ service network restart’</div><div class="line"></div><div class="line">mii-tool 查看网卡连接状态,虚拟网卡不支持</div><div class="line">hostname 显示主机名。hostname abc 即修改主机名为abc 不过这样修改只是保存在内存中，</div><div class="line">	下次重启还会变成未改之前的主机名，</div><div class="line">	所以需要你还要去更改相关的配置文件’/etc/sysconfig/network’</div><div class="line"></div><div class="line">vim /etc/resolv.conf 设置DNS 文件/etc/hosts也能解析域名，</div><div class="line">	不过是需要我们手动在里面添加IP 域名这些内容，它的作用是临时解析某个域名</div><div class="line"></div><div class="line">防火墙 将selinux关闭， vim /etc/selinux/config 将 SELINUX 修改为 disabled</div><div class="line">	iptables</div></pre></td></tr></table></figure>
<h4 id="gitlab相关"><a href="#gitlab相关" class="headerlink" title="gitlab相关"></a>gitlab相关</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">启动所有gitlab组件：</div><div class="line">gitlab-ctl start</div><div class="line"></div><div class="line">停止所有gitlab组件：</div><div class="line">gitlab-ctl stop</div><div class="line"></div><div class="line">重启所有gitlab组件：</div><div class="line">gitlab-ctl restart</div><div class="line"></div><div class="line">备份GitLab repositories and GitLab metadata</div><div class="line">加入计划任务：</div><div class="line">0 2 * * * /opt/gitlab/bin/gitlab-rake gitlab:backup:create</div><div class="line"></div><div class="line">恢复</div><div class="line">a.进入备份gitlab的目录</div><div class="line">[root@puppet backups]# pwd</div><div class="line">/var/opt/gitlab/backups</div><div class="line">[root@puppet backups]# ls</div><div class="line">1406691018_gitlab_backup.tar</div><div class="line"></div><div class="line">b.停止unicorn和sidekiq，保证数据库没有新的连接，不会有写数据情况</div><div class="line">[root@puppet backups]# gitlab-ctl stop unicorn</div><div class="line">ok: down: unicorn: 0s, normally up</div><div class="line">You have new mail in /var/spool/mail/root</div><div class="line">[root@puppet backups]# gitlab-ctl stop sidekiq</div><div class="line">ok: down: sidekiq: 0s, normally up</div><div class="line"></div><div class="line">c.恢复数据，1406691018为备份文件的时间戳</div><div class="line">[root@puppet backups]# gitlab-rake gitlab:backup:restore BACKUP=1406691018</div></pre></td></tr></table></figure>
<h4 id="生成git需要的ssh-key"><a href="#生成git需要的ssh-key" class="headerlink" title="生成git需要的ssh key"></a>生成git需要的ssh key</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh-keygen -t rsa -C &quot;youremail@example.com&quot;</div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>呵呵！</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/images/alipay.png" alt="xxyxpy Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/linux/" rel="tag"># linux</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/09/20/java/tool/生成二维码和条形码/" rel="next" title="生成二维码和条形码">
                <i class="fa fa-chevron-left"></i> 生成二维码和条形码
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/09/06/java/ssh整合/" rel="prev" title="ssh整合">
                ssh整合 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMDA2NC82NjE5"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="xxyxpy" />
          <p class="site-author-name" itemprop="name">xxyxpy</p>
           
              <p class="site-description motion-element" itemprop="description">什么鬼...</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">43</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">35</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#关闭防火墙"><span class="nav-text">关闭防火墙</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#目录操作"><span class="nav-text">目录操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#拷贝"><span class="nav-text">拷贝</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#移动文件或目录"><span class="nav-text">移动文件或目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#权限操作"><span class="nav-text">权限操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文件查找-find"><span class="nav-text">文件查找 find</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#切换用户"><span class="nav-text">切换用户</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#修改密码"><span class="nav-text">修改密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#磁盘管理"><span class="nav-text">磁盘管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#开启关闭指定端口"><span class="nav-text">开启关闭指定端口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查看tomcat的启动信息"><span class="nav-text">查看tomcat的启动信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编辑工具vim使用"><span class="nav-text">编辑工具vim使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#压缩与打包"><span class="nav-text">压缩与打包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#yum配置"><span class="nav-text">yum配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#安装源码包"><span class="nav-text">安装源码包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#shell"><span class="nav-text">shell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#系统环境变量与个人环境变量的配置文件"><span class="nav-text">系统环境变量与个人环境变量的配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#shell中的特殊符号"><span class="nav-text">shell中的特殊符号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#shell中管道命令"><span class="nav-text">shell中管道命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正则表达式"><span class="nav-text">正则表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查看程序的端口占用情况"><span class="nav-text">查看程序的端口占用情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#shell脚本"><span class="nav-text">shell脚本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#日常管理"><span class="nav-text">日常管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#gitlab相关"><span class="nav-text">gitlab相关</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#生成git需要的ssh-key"><span class="nav-text">生成git需要的ssh key</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xxyxpy</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("zUqbqNglA6pfEwKdBrBUrYlH-gzGzoHsz", "PMlOiDVYQRneIOk0dREJvKe4");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

</body>
</html>
