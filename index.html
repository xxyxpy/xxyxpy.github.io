<!DOCTYPE html>
<html lang=zh>
<head>
    <meta charset="utf-8">
    
    <title>code dog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="什么鬼...">
<meta property="og:type" content="website">
<meta property="og:title" content="code dog">
<meta property="og:url" content="http://xxyxpy.pub/index.html">
<meta property="og:site_name" content="code dog">
<meta property="og:description" content="什么鬼...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="code dog">
<meta name="twitter:description" content="什么鬼...">
    

    
        <link rel="alternate" href="/" title="code dog" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">code dog</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="/categories">Categories</a>
                
                    <a class="main-nav-link" href="/tags">Tags</a>
                
                    <a class="main-nav-link" href="https://github.com/xxyxpy/boot-my">Boot</a>
                
                    <a class="main-nav-link" href="/about">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/avatar.png" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/categories">Categories</a></td>
                
                    <td><a class="main-nav-link" href="/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="https://github.com/xxyxpy/boot-my">Boot</a></td>
                
                    <td><a class="main-nav-link" href="/about">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/avatar.png" />
            <h2 id="name">xxyxpy</h2>
            <h3 id="title">代码狗</h3>
            <span id="location"><i class="fa fa-map-marker"></i>苏州</span>
            <a id="follow" target="_blank" href="https://github.com/xxyxpy/">关注我</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                48
                <span>文章</span>
            </div>
            <div class="article-info-block">
                41
                <span>标签</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="http://github.com/xxyxpy/" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="twitter" class=tooltip>
                            <i class="fa fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="facebook" class=tooltip>
                            <i class="fa fa-facebook"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="dribbble" class=tooltip>
                            <i class="fa fa-dribbble"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="rss" class=tooltip>
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main">
    <article id="post-linux/vps相关" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/12/25/linux/vps相关/">vps相关</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/12/25/linux/vps相关/">
            <time datetime="2017-12-25T05:31:12.282Z" itemprop="datePublished">2017-12-25</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/linux/">linux</a>, <a class="tag-link" href="/tags/vps/">vps</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p><strong>路由测试</strong></p>
<p><a href="https://doub.io/linux-jc4/" target="_blank" rel="external">Linux中使用 路由追踪 测试VPS回程路由</a></p>
<p><a href="https://www.91yun.co/archives/833" target="_blank" rel="external">服务器一键测试包（12月22日更新）</a></p>
<p>wget 安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum -y install wget</div></pre></td></tr></table></figure>
<p><strong>ss开心版</strong></p>
<p><a href="https://github.com/iMeiji/shadowsocks_install/wiki" target="_blank" rel="external">链接</a></p>
<p><strong><a href="https://xratzh.com/2017/10/09/bwg3/" target="_blank" rel="external">魔改bbr加速</a></strong></p>
<p><strong>第一步</strong>安装最合适的内核，这里都指定v4.11.9</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install -y wget &amp;&amp; wget --no-check-certificate -O C71.sh https://raw.githubusercontent.com/xratzh/CBBR/master/C71.sh &amp;&amp; sudo bash C71.sh</div></pre></td></tr></table></figure>
<p>安装新内核后，输入Y，系统会自动断开putty，重启一次，重新登录后启用新的内核。</p>
<p><strong>第二步</strong>使用以下的脚本编译开启魔改的bbr。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate -O C72.sh https://raw.githubusercontent.com/xratzh/CBBR/master/C72.sh &amp;&amp; sudo bash C72.sh</div></pre></td></tr></table></figure>
<p>结束后，显示<code>Finish</code>表示正常，或者执行<code>lsmod |grep &#39;bbr_powered&#39;</code> 结果不为空,则加载模块成功。</p>
<p><strong>锐速安装</strong></p>
<p><a href="https://github.com/91yun/serverspeeder" target="_blank" rel="external">破解-官方地址91yun.co</a></p>
<p><a href="https://doub.io/ruisu-jc1/" target="_blank" rel="external">优秀的VPS TCP加速软件 —— 一键锐速安装脚本（开心版）</a></p>
<p><a href="https://www.zrj96.com/post-272.html" target="_blank" rel="external">VPS/服务器优化网络、加速方法总结与参考</a></p>
<p><a href="https://www.91yun.co/archives/833" target="_blank" rel="external">服务器一键测试包（12月22日更新）</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># centos7需要更换内核，然后重启安装</div><div class="line">rpm -ivh http://soft.91yun.org/ISO/Linux/CentOS/kernel/kernel-3.10.0-229.1.2.el7.x86_64.rpm --force</div><div class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/91yun/serverspeeder/master/serverspeeder-all.sh &amp;&amp; bash serverspeeder-all.sh</div><div class="line"># wget -N --no-check-certificate https://github.com/91yun/serverspeeder/raw/master/serverspeeder.sh &amp;&amp; bash serverspeeder.sh</div></pre></td></tr></table></figure>
<p><strong>锐速优化</strong></p>
<p><a href="https://www.mrlong.cc/1385.html" target="_blank" rel="external">锐速参数优化及配置文件详解</a></p>
<p><a href="https://doub.io/wlzy-33/" target="_blank" rel="external"><a href="https://doub.io/wlzy-33/" target="_blank" rel="external">锐速(ServerSpeeder/LotServer)配置参数简单说明，合理修改配置 提高加速效果</a></a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"># ServerSpeeder 打开配置文件：</div><div class="line">vi /serverspeeder/etc/config</div><div class="line"></div><div class="line">#发包增强 此值越高越激进，消耗的流量也越多，</div><div class="line"># 但其实也没有多少，建议48～64，过高有效包会减少，速度不增反减，</div><div class="line"># 不过对个别延迟和丢包不小的线路，可以调到600</div><div class="line">initialCwndWan=&quot;50&quot;</div><div class="line"># 关闭使锐速间歇掉速度的罪魁祸首</div><div class="line">shaperEnable=&quot;0&quot;</div><div class="line"></div><div class="line">acc=&quot;1&quot;</div><div class="line">advacc=&quot;1&quot;</div><div class="line">advinacc=&quot;1&quot;</div><div class="line">wankbps=&quot;1000000&quot;</div><div class="line">waninkbps=&quot;1000000&quot;</div><div class="line"># 这两个参数代表加速宽带为 1Gbps，再加个 0 就是10Gbps了</div><div class="line">maxmode=&quot;1&quot;</div><div class="line">initialCwndWan=&quot;44&quot;</div><div class="line"># 这个参数请根据回程延迟修改</div><div class="line"></div><div class="line"></div><div class="line"># 保存重启锐速</div><div class="line">service serverSpeeder restart</div></pre></td></tr></table></figure>
<p><strong>设置vps定时重启</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"># 安装 crontab</div><div class="line">yum install vixie-cron crontabs</div><div class="line">chkconfig crond on</div><div class="line">service crond start</div><div class="line"># 编辑定时脚本</div><div class="line">crontab -e</div><div class="line"># 每天5点定时重启</div><div class="line">0 5 * * * /sbin/reboot</div><div class="line"># 保存退出重启生效</div><div class="line">service crond stop</div><div class="line">service crond start</div><div class="line"># 查看最后一次系统启动的时间。</div><div class="line">who -b </div><div class="line"># 查看当前系统运行时间</div><div class="line">who -r </div><div class="line"># 系统历史启动的时间</div><div class="line">last reboot</div></pre></td></tr></table></figure>
<p><strong>安装apache</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"># 1.安装Apache</div><div class="line">yum install httpd</div><div class="line"># 2.设置服务器开机自动启动Apache</div><div class="line">systemctl enable httpd.service</div><div class="line"># 若要验证是否自动启动可在重启服务器后在终端键入以下命令来检测Apache是否已经启动</div><div class="line">systemctl is-enabled httpd.service</div><div class="line"># 如果看到了enable这样的响应，则表示Apache已经启动成功</div><div class="line"># 3.手动启动Apache</div><div class="line">systemctl start httpd.service</div><div class="line"># 在浏览器中输入IP地址即可验证是否启动成功</div><div class="line"># 4.手动重启Apache</div><div class="line">systemctl restart httpd.service</div><div class="line"># 5.手动停止Apache</div><div class="line">systemctl stop httpd.service</div><div class="line"># 6.安装目录介绍</div><div class="line"># Apache默认将网站的根目录指向/var/www/html</div><div class="line"># 默认的主配置文件/etc/httpd/conf/httpd.conf</div><div class="line"># 配置存储在的/etc/httpd/conf.d/目录</div></pre></td></tr></table></figure>
<p><strong>安装php探针</strong></p>
<p>必须要先有apache和php环境</p>
<p><a href="http://www.linuxdiyf.com/linux/27285.html" target="_blank" rel="external">Linux安装PHP探针</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"># 首先要安装Apahce 及 php</div><div class="line">yum -y install httpd php</div><div class="line"># 下载探针</div><div class="line">wget  http://www.yahei.net/tz/tz.zip</div><div class="line"># 创建目录</div><div class="line">mkdir -p /var/www/html</div><div class="line"># 移动到指定目录</div><div class="line">mv tz.zip /var/www/html</div><div class="line"># 解压</div><div class="line">unzip tz.zip</div><div class="line"># 重命名</div><div class="line">mv tz.php index.php</div><div class="line"># 修改apache的端口号</div><div class="line">vi /etc/httpd/conf/httpd.conf</div><div class="line"># 修改为指定端口如10000</div><div class="line">Listen 10000</div><div class="line"># 开放此端口</div><div class="line">firewall-cmd --add-port=10000/tcp</div><div class="line"># 重启apache</div><div class="line">systemctl restart httpd.service</div><div class="line"># 访问</div><div class="line">你的ip:12345</div></pre></td></tr></table></figure>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://xxyxpy.pub/2017/12/25/linux/vps相关/" data-id="cjblrlmw30091qwhqbm22jmhu" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-linux/linux" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/12/21/linux/linux/">linux</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/12/21/linux/linux/">
            <time datetime="2017-12-21T01:22:22.788Z" itemprop="datePublished">2017-12-21</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/linux/">linux</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h4 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"># 查看防火墙状态</div><div class="line">service iptables status</div><div class="line"># 查看已经开启的端口</div><div class="line">/etc/init.d/iptables status </div><div class="line"># 开启</div><div class="line">chkconfig iptables on</div><div class="line"># 关闭</div><div class="line">chkconfig iptables off</div><div class="line"></div><div class="line"># centos 7防火墙关闭，默认使用的是firewall作为防火墙，使用iptables必须重新设置一下</div><div class="line">systemctl stop firewalld.service #停止firewall</div><div class="line">systemctl disable firewalld.service #禁止firewall开机启动</div><div class="line">yum -y install iptables-services #设置 iptables service</div></pre></td></tr></table></figure>
<hr>
<h4 id="目录操作"><a href="#目录操作" class="headerlink" title="目录操作"></a>目录操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 创建目录</div><div class="line">mkdir a</div><div class="line"># -p参数，递归创建</div><div class="line">mkdir -p a/b/c</div><div class="line"># 删除目录，要求目录必须为空</div><div class="line">rmdir -p a/b/c</div><div class="line"># 删除带有数据的目录，r删除目录 f强制删除</div><div class="line">rm -rf c</div></pre></td></tr></table></figure>
<h4 id="拷贝"><a href="#拷贝" class="headerlink" title="拷贝"></a>拷贝</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cp test1.txt test2.txt</div><div class="line"># 拷贝目录需要添加 -r</div><div class="line">cp -r a/ b</div></pre></td></tr></table></figure>
<h4 id="移动文件或目录"><a href="#移动文件或目录" class="headerlink" title="移动文件或目录"></a>移动文件或目录</h4><p>可用来重命名文件或目录。不需要加-r</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mv apache-tomcat-8.0.44/  /usr/local/application/solr/tomcat-solr</div></pre></td></tr></table></figure>
<p>生成和写入文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># 有此文件时更新时间，没有时生成</div><div class="line">touch 1.txt</div><div class="line"># 写入数据到指定的文件</div><div class="line">echo &quot;abc&quot; &gt; 2.txt</div><div class="line"># 读取文件内容显示</div><div class="line">cat 2.txt</div></pre></td></tr></table></figure>
<hr>
<h4 id="权限操作"><a href="#权限操作" class="headerlink" title="权限操作"></a>权限操作</h4><p>权限分为x运行，w写入和r读取值分别为4，2，1。</p>
<p>chmod 语法： chmod [-R] xyz 文件名（这里的xyz，表示数字）</p>
<p>-R选项只作用于目录，作用是级联更改，即不仅更改当前目录，连目录里的目录或者文件全部更改</p>
<p>如果你创建了一个目录，而该目录不想让其他人看到内容，则只需设置成 rwxr—– (740) 即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"># 如果想设置全部的权限即rwx(4+2+1),设置权限值为777</div><div class="line"># b目录以及其所有的子目录和文件权限全部为rwxrwxrwx</div><div class="line">chmod -R 777 b</div><div class="line"># 可以使用r w x方式单独设置权限，使用前需要清楚以下内容</div><div class="line"># 分类user使用u表示，代表用户（前三位）；group使用g表示代表所属组（中间三位）；</div><div class="line"># other使用o表示代表其它组（最后三位）；all使用a表示以上三个（9位）</div><div class="line"># + 加入权限 - 减少权限 = 设置等于此权限</div><div class="line"># 例1：1.txt文件og添加w的权限</div><div class="line">chmod og+w 1.txt</div><div class="line"># 例2：b目录所有去掉r权限，使用a或为空表示所有</div><div class="line">chmod -r b</div><div class="line"># 例3：设置多个使用,隔开</div><div class="line">chmod u=rwx,og=rx 2.txt</div></pre></td></tr></table></figure>
<h4 id="文件查找-find"><a href="#文件查找-find" class="headerlink" title="文件查找 find"></a>文件查找 find</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># -name filename 直接查找该文件名的文件</div><div class="line">find -name temp</div><div class="line"># -type type 通过文件类型查找，文件类型有f(文件)，d（目录）,b,c,l(连接档类似于windows下的快捷方式),s</div><div class="line">find -type d</div></pre></td></tr></table></figure>
<h4 id="切换用户"><a href="#切换用户" class="headerlink" title="切换用户"></a>切换用户</h4><p> su [-] username</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">su -</div><div class="line"># 打印当前登录的用户</div><div class="line">echo $LOGNAME</div></pre></td></tr></table></figure>
<h4 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">passwd [username]</div></pre></td></tr></table></figure>
<h4 id="磁盘管理"><a href="#磁盘管理" class="headerlink" title="磁盘管理"></a>磁盘管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 查看磁盘使用情况</div><div class="line">df -h</div><div class="line"># 查看占用空间大小 du [-abckmsh] [文件或者目录名] a全部列出 c最后加总 h自动调节单位</div><div class="line">du -h nginx-1.8.0.tar.gz</div></pre></td></tr></table></figure>
<h4 id="开启关闭指定端口"><a href="#开启关闭指定端口" class="headerlink" title="开启关闭指定端口"></a>开启关闭指定端口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># 打开</div><div class="line">/sbin/iptables -I INPUT -p tcp --dport 3306 -j ACCEPT</div><div class="line"># 关闭</div><div class="line">/sbin/iptables -I INPUT -p tcp --dport 80 -j DROP</div><div class="line">/etc/rc.d/init.d/iptables save</div><div class="line"># 重启服务</div><div class="line">/etc/rc.d/init.d/iptables restart</div><div class="line"># 查看端口是否已开放</div><div class="line">/etc/init.d/iptables status</div></pre></td></tr></table></figure>
<h4 id="centos7开启指定端口"><a href="#centos7开启指定端口" class="headerlink" title="centos7开启指定端口"></a>centos7开启指定端口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 开机启用防火墙</div><div class="line">systemctl enable firewalld </div><div class="line"># 开启防火墙</div><div class="line">systemctl start firewalld</div><div class="line"># 查询是否开启80端口</div><div class="line">firewall-cmd --query-port=12345/tcp</div><div class="line"># 开启80端口 --permanent 表示永久有效</div><div class="line">firewall-cmd --add-port=80/tcp --permanent</div></pre></td></tr></table></figure>
<h4 id="查看tomcat的启动信息"><a href="#查看tomcat的启动信息" class="headerlink" title="查看tomcat的启动信息"></a>查看tomcat的启动信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tail -f logs/catalina.out</div></pre></td></tr></table></figure>
<p>拷贝目录。可以同时指定新目录名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 拷贝solr目录下的所有内容到solrhome下</div><div class="line">cp -r solr/ /usr/local/application/solr/solrhome</div></pre></td></tr></table></figure>
<h4 id="编辑工具vim使用"><a href="#编辑工具vim使用" class="headerlink" title="编辑工具vim使用"></a>编辑工具vim使用</h4><p>一般模式：默认打开文件时。可以进行上下移动光标；删除某个字符；删除某行；复制、粘贴一行或者多行。此模式下可以使用</p>
<p>编辑模式：可以用i（在当前字符前插入字符）I（在当前行首插入字符）a（在当前字符后插入字符）A（在当前行末插入字符）o（在当前行下插入新的一行）O（在当前行上插入新的一行）。进入编辑模式时，会在屏幕的最下一行出现“INSERT或REPLACE”的字样。从编辑模式回到一般模式只需要按一下键盘左上方的ESC键即可</p>
<p>命令模式：在一般模式下，输入”:”或者”/”即可进入命令模式。在该模式下，你可以搜索某个字符或者字符<br>串，也可以保存、替换、退出、显示行号等等</p>
<p>:w 将编辑过的文档保存。</p>
<p>:w! 若文本属性为只读时强制保存</p>
<p>:q 退出vim :q! 不管编辑或未编辑都不保存退出</p>
<p>:wq 保存并退出</p>
<p>:set nu 在行首显示行号 :set nonu 取消行号</p>
<p>翻前页：ctrl+f或pageup</p>
<p>翻后页：ctrl+b或pagedown</p>
<p>查找：/word 查找到光标之后的word字符串，n可以继续查找下一个，N可以查找上一个。?word可以查找到光标之前的word字符串</p>
<h4 id="压缩与打包"><a href="#压缩与打包" class="headerlink" title="压缩与打包"></a>压缩与打包</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"># 压缩文件gzip [-d#] filename 其中#为1-9的数字。不可以压缩目录</div><div class="line"># -d ：解压缩时使用</div><div class="line"># -# ：压缩等级，1压缩最差，9压缩最好，6为默认</div><div class="line">gzip schema.xml</div><div class="line"># 解压</div><div class="line">gzip -d schema.xml.gz</div><div class="line">########### tar #############</div><div class="line"># tar [-zjxcvfpP] filename</div><div class="line"># -z ：是否同时用gzip压缩</div><div class="line"># -j ：是否同时用bzip2压缩</div><div class="line"># -x ：解包或者解压缩</div><div class="line"># -t ：查看tar包里面的文件</div><div class="line"># -c ：建立一个tar包或者压缩文件包</div><div class="line"># -v ：可视化</div><div class="line"># -f ：后面跟文件名，压缩时跟-f文件名，意思是压缩后的文件名为filename，解压时跟-f文件名，</div><div class="line"># 意思是解压filename。请注意，如果是多个参数组合的情况下带有-f，请把f写到最后面。</div><div class="line"># -p ：使用原文件的属性，压缩前什么属性压缩后还什么属性。（不常用）</div><div class="line"># -P ：可以使用绝对路径。（不常用）</div><div class="line"># --exclude filename ：在打包或者压缩时，不要将filename文件包括在内。（不常用）</div><div class="line"></div><div class="line"># 压缩 b目录-&gt;b.tar</div><div class="line">tar -cvf b.tar b</div><div class="line"># 解压</div><div class="line">tar -xvf b.tar </div><div class="line"># 打包同时使用gzip压缩</div><div class="line">tar -zcvf b.tar.gz b </div><div class="line"># 只查看压缩包内的内容，不解压</div><div class="line">tar -tf b.tar.gz</div></pre></td></tr></table></figure>
<h4 id="yum配置"><a href="#yum配置" class="headerlink" title="yum配置"></a>yum配置</h4><p>CentOS则你可以从/etc/yum.repos.d/CentOS-Base.repo这个文件下看到相关的配置信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># 搜索包</div><div class="line">yum search vim</div><div class="line">yum list |grep vim</div><div class="line"># 安装一个rpm包 yum install [-y] [rpm包名] -y选项，会以与用户交互的方式安装</div><div class="line"># 卸载一个rpm包 “yum remove [-y] [rpm包名]”</div><div class="line"># 升级一个rpm包 “yum update [-y] [rpm包]”</div></pre></td></tr></table></figure>
<h4 id="安装源码包"><a href="#安装源码包" class="headerlink" title="安装源码包"></a>安装源码包</h4><p>三个步骤</p>
<ol>
<li>./config 在这一步可以定制功能，加上相应的选项即可，具有有什么选项可以通过”./config –help ”命令来<br>查看。在这一步会自动检测你的linux系统与相关的套件是否有编译该源码包时需要的库，因为一旦缺少某个库就<br>不能完成编译。只有检测通过后才会生成一个Makefile文件。</li>
<li>make 使用这个命令会根据Makefile文件（必须要有此文件）中预设的参数进行编译，这一步其实就是gcc在工作了。</li>
<li>make install 安装步骤，生成相关的软件存放目录和配置文件的过程</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># 下载安装tomcat</div><div class="line"># 1 下载源码包</div><div class="line">wget http://apache.mirrors.ionfish.org/tomcat/tomcat-8/v8.0.46/bin/apache-tomcat-8.0.46.tar.gz</div><div class="line"># 2 解压源码包</div><div class="line"></div><div class="line"># 3 配置相关选项，生成makefile</div><div class="line"></div><div class="line"># 4 编译</div><div class="line"></div><div class="line"># 5 安装</div></pre></td></tr></table></figure>
<h4 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"># 1 历史命令。!!执行上一条 !n 执行命令历史中第n条指令 !字符串（字符串大于等于1），例如!ta，表示执行命令	# 历史中最近一次以ta为开头的指令</div><div class="line"># 2 指令和文件名补全 按tab键，它可以帮你补全一个指令，也可以帮你补</div><div class="line">	# 全一个路径或者一个文件名。连续按两次tab键，系统则会把所有的指令或者文件名都列出来</div><div class="line"># 3 别名。alias显示所有的别名</div><div class="line"># 4 通配符，使用*来匹配零个或多个字符，而用?匹配一个字符</div><div class="line">ls -d test*</div><div class="line"># 5 输入输出重定向。输出重定向&gt;，追加重定向&gt;&gt;</div><div class="line"># 6 管道|，就是把前面的命令运行的结果丢给后面的命令</div><div class="line"># 7 作业控制。当运行一个进程时，你可以使它暂停（按Ctrl+z），然后使用fg命令恢复它，利用bg命令使他到后台运</div><div class="line">	# 行，你也可以使它终止（按Ctrl+c）</div><div class="line"></div><div class="line"># 查看环境变量PATH等信息</div><div class="line">echo $PATH</div><div class="line">echo $PWD</div><div class="line">echo $HOME</div><div class="line">echo $LOGNAME</div><div class="line"># 查看所有的预设环境变量</div><div class="line">env</div><div class="line">set</div><div class="line"># 用户自定义变量，只在当前的shell中生效。使用bash命令即可再打开一个shell</div><div class="line">myname=Aming</div><div class="line">echo $myname</div><div class="line"># 1 如果想系统内所有用户登录后都能使用该变量。需要在/etc/profile文件最末行加入 “export myname=Aming” </div><div class="line">	# 然后运行”source /etc/profile”就可以生效了。此时你再运行bash命令或者直接su - test账户看看</div><div class="line"># 2 只想让当前用户使用该变量。需要在用户主目录下的.bashrc文件最后一行加入“export myname=Aming”</div><div class="line">然后运行”source .bashrc”就可以生效了。这时候再登录test账户，myname变量则不会生效了。</div><div class="line">上面用的source命令的作用是，讲目前设定的配置刷新，即不用注销再登录也能生效</div><div class="line">	</div><div class="line"># pstree 把linux系统中所有进程通过树形结构打印出来</div><div class="line">pstree |grep bash</div><div class="line"># export 指令父shell中设定一个变量后，进入子shell后该变量是不会生效的，</div><div class="line">	# 如果想让这个变量在子shell中生效则要用到export指令。export其实就是声明一下这个变量的意思，</div><div class="line">	# 让该shell的子shell也知道变量abc的值是123.如果export后面不加任何变量名，则它会声明所有的变量。</div><div class="line"># 取消一个设置的变量</div><div class="line">abc=123</div><div class="line">echo $abc</div><div class="line">unset abc</div></pre></td></tr></table></figure>
<h4 id="系统环境变量与个人环境变量的配置文件"><a href="#系统环境变量与个人环境变量的配置文件" class="headerlink" title="系统环境变量与个人环境变量的配置文件"></a>系统环境变量与个人环境变量的配置文件</h4><p>系统级别：</p>
<p>/etc/profile：这个文件预设了几个重要的变量，例如PATH, USER, LOGNAME, MAIL…</p>
<p>/etc/bashrc ：这个文件主要预设umask以及PS1。这个PS1就是我们在敲命令时，前面那串字符了</p>
<p>用户级别（在用户目录下）：</p>
<p>.bash_profile：定义了用户的个人化路径与环境变量的文件名称。每个用户都可使用该文件输入专用于自己使用<br>的shell信息,当用户登录时,该文件仅仅执行一次</p>
<p>.bashrc：该文件包含专用于你的shell的bash信息,当登录时以及每次打开新的shell时,该该文件被读取。例如你<br>可以将用户自定义的alias或者自定义变量写到这个文件中。</p>
<p>.bash_history：记录命令历史用的。</p>
<p>.bash_logout ：当退出shell时，会执行该文件。可以把一些清理的工作放到这个文件中。</p>
<h4 id="shell中的特殊符号"><a href="#shell中的特殊符号" class="headerlink" title="shell中的特殊符号"></a>shell中的特殊符号</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"># 1 * 代表0个或多个字符或数字</div><div class="line">ls -d test*</div><div class="line"># 2 ? 代表一个任意字符</div><div class="line">touch testa testb testc</div><div class="line">ls -d test?</div><div class="line"># 3 # 代表注释的意思</div><div class="line"># 4 \ 转入字符，将特殊符号进行转入</div><div class="line">ls test\*</div><div class="line"># 5 | 管道符。用于将特号前面执行的结果丢给符号后面的命令</div><div class="line"># 6 $ 一种方式是作为变量前的标识符，另外和！结合起来使用 !$ 表示上条命令中最后一个变量</div><div class="line">ls testa # show testa</div><div class="line">ls !$ # show ls testa  testa</div></pre></td></tr></table></figure>
<h4 id="shell中管道命令"><a href="#shell中管道命令" class="headerlink" title="shell中管道命令"></a>shell中管道命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"># 1 grep 过滤一个或多个字符</div><div class="line">cat /etc/passwd |grep root</div><div class="line"># 2 cut：截取某一个字段 语法：cut -d “分隔字符” [-cf] n 这里的n是数字</div><div class="line">	# -d ：后面跟分隔字符，分隔字符要用双引号括起来</div><div class="line">	# -c ：后面接的是第几个字符</div><div class="line">	# -f ：后面接的是第几个区块</div><div class="line">cat /etc/passwd |cut -d &quot;:&quot; -f 1</div><div class="line"># 3 sort 用做排序 语法：sort [-t 分隔符] [-kn1,n2] [-nru] 这里的n1 &lt; n2</div><div class="line">	# -t 分隔符：作用跟cut的-d一个意思</div><div class="line">	# 第 12 章 学习 shell 脚本之前的基础知识 | 151</div><div class="line">	# -n ：使用纯数字排序</div><div class="line">	# -r ：反向排序</div><div class="line">	# -u ：去重复</div><div class="line">	# -kn1,n2 ：由n1区间排序到n2区间，可以只写-kn1，即对n1字段排序</div><div class="line">head -n5 /etc/passwd |sort -t: -k3n</div><div class="line"># 4 wc：统计文档的行数、字符数、词数，常用的选项为：</div><div class="line">	# -l ：统计行数</div><div class="line">	# -m ：统计字符数</div><div class="line">	# -w ：统计词数</div><div class="line">cat 1.txt |wc -l</div><div class="line">cat 1.txt |wc -m</div><div class="line">cat 1.txt |wc -w</div><div class="line"># 5 uniq：去重复的行 在进行uniq之前，需要先用sort排序然后才能uniq，否则你将得不到你想要的</div><div class="line">	# -c ：统计重复的行数，并把行数写在前面</div><div class="line">cat 1.txt |uniq</div><div class="line">cat 1.txt |uniq -c</div><div class="line"># 6 tee ：后跟文件名，类似与重定向”&gt;”，但是比重定向多了一个功能，在把文件写入后面所跟的文件中的同</div><div class="line">	# 时，还显示在屏幕上。</div><div class="line">echo &quot;haha&quot; |tee 1.txt</div><div class="line"># 7 tr 替换字符-d ：删除某个字符，-d 后面跟要删除的字符 -s ：把重复的字符去掉</div><div class="line"># 小写转大写</div><div class="line">cat 1.txt |tr &apos;[a-z]&apos; &apos;[A-Z]&apos;</div><div class="line"># 单个字符替换</div><div class="line">cat 1.txt |grep a |tr &apos;d&apos; &apos;D&apos;</div><div class="line"># 8 split ：切割文档，常用选项：</div><div class="line">	# -b ：依据大小来分割文档，单位为byte</div><div class="line">	# -l ：依据行数来分割文档</div><div class="line">split -b 500 3.txt my</div><div class="line">split -l 1 1.txt your</div><div class="line"># 9 分号：平时我们都是在一行中敲一个命令，然后回车就运行了，那么想在一行中运行两个或两个以上的命</div><div class="line">	# 令如何呢？则需要在命令之间加一个”;”了</div><div class="line">ls -d test*;touch test5;ls -d test*	</div><div class="line"># 10 &amp; ：如果想把一条命令放到后台执行的话，则需要加上这个符号。通常用于命令运行时间非常长的情况</div><div class="line">sleep 100 &amp;</div><div class="line"># 查看后台任务jobs可以查看当前shell中后台执行的任务。用fg可以调到前台执行。</div><div class="line"># 这里的sleep命令就是休眠的意思，后面跟数字，单位为秒，常用语循环的shell脚本中</div><div class="line"># 此时你按一下CTRL +z 使之暂停，然后再输入bg可以再次进入后台执行</div><div class="line"># 如果是多任务情况下，想要把任务调到前台执行的话，fg后面跟任务号，任务号可以使用jobs命令得到</div><div class="line">jobs</div><div class="line"># 11   &gt;, &gt;&gt;, 2&gt;, 2&gt;&gt;：前面讲过重定向符号&gt; 以及&gt;&gt;　分别表示取代和追加的意思，</div><div class="line"># 然后还有两个符号就是这里的2&gt; 和 2&gt;&gt;　分别表示错误重定向和错误追加重定向，当我们运行一个命令报错时，</div><div class="line"># 报错信息会输出到当前的屏幕，如果想重定向到一个文本里，则要用2&gt;或者2&gt;&gt;</div><div class="line"># 12  [ ]：中括号，中间为字符组合，代表中间字符中的任意一个</div><div class="line">ll test[a-c]</div><div class="line"># 12 &amp;&amp; || 两条命令时类似于java中的判断</div><div class="line">ls testa &amp;&amp; touch test11</div></pre></td></tr></table></figure>
<hr>
<h4 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h4><p>grep 语法： grep [-cinvABC] ‘word’ filename</p>
<p>-c ：打印符合要求的行数<br>-i ：忽略大小写<br>-n ：在输出符合要求的行的同时连同行号一起输出<br>-v ：打印不符合要求的行<br>-A ：后跟一个数字（有无空格都可以），例如 –A2则表示打印符合要求的行以及下面两行<br>-B ：后跟一个数字，例如 –B2 则表示打印符合要求的行以及上面两行<br>-C ：后跟一个数字，例如 –C2 则表示打印符合要求的行以及上下各两行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"># 过滤出带有某个关键词的行并输出行号</div><div class="line">grep -n &apos;root&apos; /etc/passwd</div><div class="line"># 过滤不带有某个关键词的行，并输出行号</div><div class="line">grep -vn &quot;nologin&quot; /etc/passwd</div><div class="line"># 过滤出所有包含数字的行 如果要过滤出数字以及大小写字母则要这样写[0-9a-zA-Z]</div><div class="line">grep [0-9] 123.txt</div><div class="line"># 以某个字段开头或以某个字段结尾的行。^ 开头 $ 结尾 grep -v ‘^$’ filename表示非空行</div><div class="line">grep &apos;^a&apos; 1.txt</div><div class="line">grep &apos;a$&apos; 1.txt</div><div class="line"># 过滤任意一个字符与重复字符 . 表示任意一个字符，* 表示0个或多个字符</div><div class="line">grep &apos;a..d&apos; 1.txt</div><div class="line">grep &apos;a*&apos; 1.txt</div><div class="line"># 指定要过滤字符出现的次数</div><div class="line">grep &apos;c\&#123;1\&#125;&apos; 1.txt</div></pre></td></tr></table></figure>
<hr>
<h4 id="查看程序的端口占用情况"><a href="#查看程序的端口占用情况" class="headerlink" title="查看程序的端口占用情况"></a>查看程序的端口占用情况</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"># 查看tomcat端口占用</div><div class="line">ps -aux | grep tomcat</div><div class="line"># 查看所有的进程和端口使用情况 其中最后一栏是PID/Program name </div><div class="line">netstat –apn</div><div class="line"># 根据结果中的PID查看是哪个程序在占用。发现8080端口被PID为9658的Java进程占用。</div><div class="line"># 进一步使用命令：ps -aux | grep java，或者直接：ps -aux | grep pid 查看</div><div class="line"># 找到后使用KILL命令结束掉</div><div class="line">ps -aux | grep java</div><div class="line">ps -aux | grep pid </div><div class="line"># 方法二：直接使用 netstat   -anp   |   grep  portno</div><div class="line"># 即：netstat –apn | grep 8080</div><div class="line"></div><div class="line"># centos中</div><div class="line"># 比如查看80端口占用情况</div><div class="line">lsof -i tcp:80</div><div class="line"># 列出所有端口</div><div class="line">netstat -ntlp</div><div class="line"></div><div class="line"># centos 7 3306端口占用情况</div><div class="line">ss -lnp|grep 3306</div></pre></td></tr></table></figure>
<hr>
<h4 id="shell脚本"><a href="#shell脚本" class="headerlink" title="shell脚本"></a>shell脚本</h4><p>凡是自定义的脚本建议放到/usr/local/sbin/目录下</p>
<p>test.sh中第一行一定是 “#! /bin/bash”它代表的意思是，该文件使用的是bash语法</p>
<p>默认我们用vim编辑的文档是不带有执行权限的，所以需要加一个执行权限</p>
<p>使用sh命令去执行一个shell脚本的时候是可以加-x选项来查看这个脚本执行过程的 sh -x test.sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># date 格式化日期 W表示星期</div><div class="line">date &quot;+%Y%m%d %H:%M:%S&quot; </div><div class="line"># 天数加减</div><div class="line">date -d &quot;-1 day&quot; &quot;+%Y%m%d&quot;</div></pre></td></tr></table></figure>
<p>在shell中使用变量</p>
<p>反引号表示执行里面的内容。变量的引用要用$开头后面跟上变量名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line"></div><div class="line">d=`date +%H:%M:%S`</div><div class="line">echo &quot;the script begin at $d&quot;</div><div class="line">echo &quot;now we will sleep 2 seconds.&quot;</div><div class="line">sleep 2</div><div class="line">d1=`date +%H:%M:%S`</div><div class="line">echo &quot;the script end at $d1</div></pre></td></tr></table></figure>
<p>数学计算要用[]括起来并且以$开头</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">a=1</div><div class="line">b=2</div><div class="line">sum=$[$a+$b]</div><div class="line"></div><div class="line">echo &quot;sum is $sum&quot;</div></pre></td></tr></table></figure>
<p>和用户交互，提供输入功能.read表示需要用户通过键盘进行输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">echo &quot;Please input a number:&quot;</div><div class="line">read x</div><div class="line">echo &quot;Please input another number:&quot;</div><div class="line">read y</div><div class="line">sum=$[$x+$y]</div><div class="line">echo &quot;The sum of tow number is:$sum.&quot;</div></pre></td></tr></table></figure>
<p>另外一种更为简单的方式。read -p选项类似于echo的作用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">read -p &quot;Please input a number:&quot; x</div><div class="line">read -p &quot;Please input another number:&quot; y</div><div class="line">sum=$[$x+$y]</div><div class="line">echo &quot;The sum of tow number is:$sum.&quot;</div></pre></td></tr></table></figure>
<p>shell脚本的预设变量，例如/etc/init.d/iptables restart </p>
<p>以下脚本执行 sh -x test6.sh 1 2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">sum=$[$1+$2]</div><div class="line">echo $sum</div><div class="line">echo $0 $1 $2</div></pre></td></tr></table></figure>
<p>shell脚本中的逻辑判断</p>
<p>不带else. ((a&lt;60))这样的形式，这是shell脚本中特有的格式，用一个小括号或者不用都会报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">read -p &quot;Please input your score:&quot; a</div><div class="line">if ((a&lt;60)); then</div><div class="line">	echo &quot;You didn&apos;t pass the exam.&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>带else</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">read -p &quot;Please input your score:&quot; a</div><div class="line">if ((a&lt;60)); then</div><div class="line">	echo &quot;You didn&apos;t pass the exam.&quot;</div><div class="line">else</div><div class="line">	echo &quot;Good! You pass the exam.&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>带elif的多重判断   &amp;&amp; 表示“并且”的意思，当然你也可以使用 || 表示“或者”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">read -p &quot;Please input your score:&quot; a</div><div class="line">if ((a&lt;60)); then</div><div class="line">	echo &quot;You didn&apos;t pass the exam.&quot;</div><div class="line">elif ((a&gt;60)) &amp;&amp; ((a&lt;85)); then</div><div class="line">	echo &quot;Good! You pass the exam.&quot;</div><div class="line">else</div><div class="line">	echo &quot;Very Good! Your Score is very high.&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>在判断数值大小除了可以用”(( ))”的形式外，还可以使用”[ ]”。但是就<br>不能使用&gt;, &lt; , = 这样的符号了，要使用 -lt （小于），-gt （大于），-le （小于等于），-ge （大于等<br>于），-eq （等于），-ne （不等于）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a=10;if [ $a -lt 5 ]; then echo ok;fi</div><div class="line">a=10;if [ $a -gt 5 ]; then echo ok;fi</div></pre></td></tr></table></figure>
<p>shell 脚本中if还经常判断关于档案属性，比如判断是普通文件还是目录，判断文件是否有读写执行权限等</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">-e ：判断文件或目录是否存在</div><div class="line">-d ：判断是不是目录，并是否存在</div><div class="line">-f ：判断是否是普通文件，并存在</div><div class="line">-r ：判断文档是否有读权限</div><div class="line">-w ：判断是否有写权限</div><div class="line">-x ：判断是否可执行</div><div class="line">if [ -d /home ] ; then echo ok; fi</div><div class="line">if [ -f /home ] ; then echo ok; fi</div></pre></td></tr></table></figure>
<p>shell脚本中使用case</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">case 变量 in</div><div class="line">value1)</div><div class="line">command</div><div class="line">;;</div><div class="line">value2)</div><div class="line">command</div><div class="line">;;</div><div class="line">value3)</div><div class="line">command</div><div class="line">;;</div><div class="line">*)</div><div class="line">command</div><div class="line">;;</div><div class="line">esac</div><div class="line"></div><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">read -p &quot;Please input a number:&quot; n</div><div class="line">a=$[$n%2]</div><div class="line">case $a in </div><div class="line">1)</div><div class="line">	echo &quot;The number is odd&quot;</div><div class="line">	;;</div><div class="line">0)</div><div class="line">	echo &quot;The number is even&quot;</div><div class="line">esac</div></pre></td></tr></table></figure>
<p>shell脚本中使用for while循环</p>
<p>seq 1 5 表示从1到5的一个序列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">for 变量名 in 循环的条件； do</div><div class="line">command</div><div class="line">done</div><div class="line"></div><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">for i in `seq 1 5`; do</div><div class="line">	echo $i</div><div class="line">done</div><div class="line"></div><div class="line"># 循环的条件那一部分也可以写成这样的形式，中间用空格隔开即可</div><div class="line">for i in 1 2 3 4 5; do echo $i; done</div><div class="line"></div><div class="line">while 条件; do</div><div class="line">command</div><div class="line">done</div><div class="line"></div><div class="line">#! /bin/bash</div><div class="line"></div><div class="line">a=10</div><div class="line">while [ $a -ge 1 ]; do</div><div class="line">	echo &quot;$a&quot;</div><div class="line">	a=$[$a-1]</div><div class="line">done</div><div class="line"></div><div class="line"># 忽略掉while中的条件 </div><div class="line">while :; do</div><div class="line">command</div><div class="line">done</div></pre></td></tr></table></figure>
<p>shell脚本中的函数</p>
<p>shell脚本中，函数一定要写在最前面，不能出现在中间或者最后</p>
<p>function 函数名() {<br>command<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#! /bin/bash</div><div class="line">function sum()&#123;</div><div class="line">  sum=$[$1+$2]</div><div class="line">  echo $sum</div><div class="line">&#125;</div><div class="line"></div><div class="line">sum $1 $2</div></pre></td></tr></table></figure>
<hr>
<h4 id="日常管理"><a href="#日常管理" class="headerlink" title="日常管理"></a>日常管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">w  查看当前系统的负载</div><div class="line">vmstat  监控系统的状态</div><div class="line">top 显示进程所占系统资源</div><div class="line">sar -n DEV 查看网卡流量 </div><div class="line">sar -q 查看历史负载 </div><div class="line">free 查看内存使用状况</div><div class="line">ps aux 查看系统进程 进程id可以用 kill pid杀掉。杀不掉的可以使用 kill -9 pid</div><div class="line">	可以用ps aux |grep redis进行筛选</div><div class="line">netstat  查看网络状况 netstat -lnp（打印当前系统启动哪些端口）以及netstat -an （打印网络连接状况）</div><div class="line">tcpdump  抓包工具 yum install -y tcpdump 命令去安装一下</div><div class="line">ifconfig  查看网卡ip 设置IP非常简单修改配置文件/etc/sysconfig/networ</div><div class="line">k-scripts/ifcfg-eth0了，如果是eth1那么配置文件是/etc/sysconfig/network-scripts/ifcfg-eth1.如果你的linux是通过dhcp服务器自动获得的IP，BOOTPROTO那里会是’dhcp’，如果你要配置成静</div><div class="line">	态IP的话，这里就需要写成’none’当修改完IP后需要重启网络服务新IP才能生效，重</div><div class="line">	启命令为’ service network restart’</div><div class="line"></div><div class="line">mii-tool 查看网卡连接状态,虚拟网卡不支持</div><div class="line">hostname 显示主机名。hostname abc 即修改主机名为abc 不过这样修改只是保存在内存中，</div><div class="line">	下次重启还会变成未改之前的主机名，</div><div class="line">	所以需要你还要去更改相关的配置文件’/etc/sysconfig/network’</div><div class="line"></div><div class="line">vim /etc/resolv.conf 设置DNS 文件/etc/hosts也能解析域名，</div><div class="line">	不过是需要我们手动在里面添加IP 域名这些内容，它的作用是临时解析某个域名</div><div class="line"></div><div class="line">防火墙 将selinux关闭， vim /etc/selinux/config 将 SELINUX 修改为 disabled</div><div class="line">	iptables</div><div class="line">who -b 查看最后一次系统启动的时间。</div><div class="line">who -r 查看当前系统运行时间</div><div class="line">last reboot 系统历史启动的时间</div><div class="line">df -l -m 查看硬盘使用情况</div></pre></td></tr></table></figure>
<h4 id="gitlab相关"><a href="#gitlab相关" class="headerlink" title="gitlab相关"></a>gitlab相关</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">启动所有gitlab组件：</div><div class="line">gitlab-ctl start</div><div class="line"></div><div class="line">停止所有gitlab组件：</div><div class="line">gitlab-ctl stop</div><div class="line"></div><div class="line">重启所有gitlab组件：</div><div class="line">gitlab-ctl restart</div><div class="line"></div><div class="line">备份GitLab repositories and GitLab metadata</div><div class="line">加入计划任务：</div><div class="line">0 2 * * * /opt/gitlab/bin/gitlab-rake gitlab:backup:create</div><div class="line"></div><div class="line">恢复</div><div class="line">a.进入备份gitlab的目录</div><div class="line">[root@puppet backups]# pwd</div><div class="line">/var/opt/gitlab/backups</div><div class="line">[root@puppet backups]# ls</div><div class="line">1406691018_gitlab_backup.tar</div><div class="line"></div><div class="line">b.停止unicorn和sidekiq，保证数据库没有新的连接，不会有写数据情况</div><div class="line">[root@puppet backups]# gitlab-ctl stop unicorn</div><div class="line">ok: down: unicorn: 0s, normally up</div><div class="line">You have new mail in /var/spool/mail/root</div><div class="line">[root@puppet backups]# gitlab-ctl stop sidekiq</div><div class="line">ok: down: sidekiq: 0s, normally up</div><div class="line"></div><div class="line">c.恢复数据，1406691018为备份文件的时间戳</div><div class="line">[root@puppet backups]# gitlab-rake gitlab:backup:restore BACKUP=1406691018</div></pre></td></tr></table></figure>
<hr>
<h4 id="生成git需要的ssh-key"><a href="#生成git需要的ssh-key" class="headerlink" title="生成git需要的ssh key"></a>生成git需要的ssh key</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh-keygen -t rsa -C &quot;youremail@example.com&quot;</div></pre></td></tr></table></figure>
<hr>
<h4 id="idea授权服务器自启动"><a href="#idea授权服务器自启动" class="headerlink" title="idea授权服务器自启动"></a>idea授权服务器自启动</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 修改/etc/rc.local，添加如下内容</div><div class="line">nohup ./usr/local/ideaServer/IntelliJIDEALicenseServer_linux_amd64 -l vps的ip -p 1017</div></pre></td></tr></table></figure>
<hr>
<h4 id="服务器每天定时重启"><a href="#服务器每天定时重启" class="headerlink" title="服务器每天定时重启"></a>服务器每天定时重启</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># 安装 crontab</div><div class="line">yum install vixie-cron crontabs</div><div class="line">chkconfig crond on</div><div class="line">service crond start</div><div class="line"># 编辑定时脚本</div><div class="line">crontab -e</div><div class="line"># 每天5点定时重启</div><div class="line">0 5 * * * /sbin/reboot</div><div class="line"># 保存退出重启生效</div><div class="line">/etc/rc.d/init.d/crond stop</div><div class="line">/etc/rc.d/init.d/crond start</div></pre></td></tr></table></figure>
<hr>
<h4 id="查看SS的网络连接情况"><a href="#查看SS的网络连接情况" class="headerlink" title="查看SS的网络连接情况"></a>查看SS的网络连接情况</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">netstat -anp |grep &apos;ESTABLISHED&apos; |grep &apos;1213&apos;</div></pre></td></tr></table></figure>
<hr>
<h3 id="yum-操作"><a href="#yum-操作" class="headerlink" title="yum 操作"></a>yum 操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 查询mysql的源列表</div><div class="line">yum list|grep mysql</div></pre></td></tr></table></figure>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://xxyxpy.pub/2017/12/21/linux/linux/" data-id="cjblrl7az000yqwhqal5ziw7n" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-linux/docker" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/12/20/linux/docker/">docker</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/12/20/linux/docker/">
            <time datetime="2017-12-20T01:59:03.718Z" itemprop="datePublished">2017-12-20</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/docker/">docker</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>在centos中安装时内核需要在3.10以上，所以必须要centos7以上版本</p>
<p>os的下载可以访问<a href="http://mirrors.aliyun.com/centos/7.3.1611/isos/x86_64/CentOS-7-x86_64-DVD-1611.iso" target="_blank" rel="external">阿里云</a></p>
<p>安装教程可参考<a href="https://wizardforcel.gitbooks.io/vbird-linux-basic-4e/content/27.html" target="_blank" rel="external">鸟哥的linux</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 查看系统内核版本</div><div class="line">uname -r</div><div class="line"># 安装</div><div class="line">yum -y install docker</div><div class="line"># 更新</div><div class="line">yum -y update docker</div><div class="line"># 启动</div><div class="line">service docker start</div></pre></td></tr></table></figure>
<hr>
<h3 id="设置镜像加速"><a href="#设置镜像加速" class="headerlink" title="设置镜像加速"></a>设置镜像加速</h3><p>进入<a href="https://cr.console.aliyun.com/" target="_blank" rel="external">阿里云镜像仓库</a>设置,通过修改daemon配置文件<code>/etc/docker/daemon.json</code>来使用加速器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">sudo mkdir -p /etc/docker</div><div class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-&apos;EOF&apos;</div><div class="line">&#123;</div><div class="line">  &quot;registry-mirrors&quot;: [&quot;https://xxx.mirror.aliyuncs.com&quot;]</div><div class="line">&#125;</div><div class="line">EOF</div><div class="line">sudo systemctl daemon-reload</div><div class="line">sudo systemctl restart docker</div></pre></td></tr></table></figure>
<hr>
<h3 id="登录docker-hub"><a href="#登录docker-hub" class="headerlink" title="登录docker hub"></a>登录docker hub</h3><p>类似于maven的仓库，需要先在<a href="https://hub.docker.com/" target="_blank" rel="external">官方网站</a>申请帐号。然后进行登录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># login</div><div class="line">docker login</div><div class="line"># 下载java镜像 docker pull 镜像名</div><div class="line">docker pull java</div><div class="line"># 查看本地所有镜像</div><div class="line">docker images</div><div class="line"># 镜像检索 docker search 镜像名</div><div class="line">docker search redis</div></pre></td></tr></table></figure>
<hr>
<h3 id="镜像操作"><a href="#镜像操作" class="headerlink" title="镜像操作"></a>镜像操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># 查看本地所有镜像</div><div class="line">docker images</div><div class="line"># 下载镜像 docker pull 镜像名</div><div class="line">docker pull java</div><div class="line"># 镜像检索 docker search 镜像名</div><div class="line">docker search redis</div><div class="line"># 删除 </div><div class="line">docker rmi image-id</div><div class="line"># 删除所有</div><div class="line">docker rmi $&#123;docker images -q&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="容器操作"><a href="#容器操作" class="headerlink" title="容器操作"></a>容器操作</h3><p>运行命令<code>docker run --name container-name -d image-name</code></p>
<blockquote>
<p>–name 参数是为容器取的名字</p>
<p>-d 表示detached，执行完这句命令后控制台不会被独占</p>
<p>image-name 指要使用哪个镜像来运行容器</p>
<p>假如运行redis,相当于添加到容器列表</p>
<p>docker run –name test-redis -d redis</p>
</blockquote>
<p>容器启动主要通过<code>docker run + 可选参数 + 容器编号/容器名 + 启动命令</code></p>
<blockquote>
<p>如： <code>docker run hello-world</code></p>
<ul>
<li><code>-d</code> 后台启动容器，默认情况下启动容器是非后台启动，启动以后会自动进入容器内部，而且一旦退出容器，容器也会自动关闭。加上该命令后，使用后台启动的方式启动容器，启动以后不会自动进入容器内部，只会返回容器编号。容器在后台自动运行。</li>
<li><code>-p port:port</code> 将指定容器的端口号映射为机器的端口号，前一个port为主机的端口号，后一个port为容器的端口号。</li>
<li><code>-v path:path</code> 将主机的一个硬盘目录或文件挂载到容器的指定位置。前一个path为主机的目录路径或文件，可以为绝对路径，也可以是一个自定义名称，如果是自定义名称，你可以在<code>/var/lib/docker/volumes</code>目录下找到；后一个path为容器内的路径，一般是绝对路径。</li>
<li><code>--name</code> 给容器起一个别名</li>
</ul>
<p>介绍了启动容器的基本命令，我们试着来直接启动一个java容器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; docker run -d -it -p 8080:8080 -v /data/test.jar:/data/test.jar --name java docker.io/java java -jar /data/test.jar</div><div class="line">&gt;</div></pre></td></tr></table></figure>
</blockquote>
<p><strong>查看运行中的容器列表</strong></p>
<p><code>docker ps</code></p>
<p><strong>查看运行和停止状态的容器列表</strong></p>
<p><code>docker ps -a</code></p>
<p><strong>停止容器</strong> <code>docker stop container-name/container-id</code></p>
<p><code>docker stop test-redis</code></p>
<p><strong>启动容器</strong><code>docker start container-name/container-id</code></p>
<p><code>docker start test-redis</code></p>
<p><strong>端口映射</strong></p>
<p>容器中运行的软件所使用的端口在本机和本机的局域网内是不能访问的，需要将dicker容器中的端口映射到当前主要的端口上。</p>
<p><strong>映射容器的6379端口到本地的6378端口</strong></p>
<p><code>docker run -d -p 6378:6379 --name port-redis -d redis</code></p>
<p><strong>删除容器</strong></p>
<p>单个<code>docker rm container-id</code></p>
<p>所有<code>docker rm ${docker ps -a -q}</code></p>
<p><strong>容器日志</strong></p>
<p>指定容器的日志 <code>docker logs container-name/container-id</code></p>
<p>eg：<code>dokcer logs port-redis</code></p>
<p><strong>登录容器</strong><br>运行中的容器产是一个功能完备的linux操作系统，可以像常规系统一样登录并访问容器，并可以通过<code>exit</code>退出。命令如下：</p>
<p><code>docker exec -it container-name/container-id bash</code></p>
<p><strong>在容器中安装vim</strong></p>
<p>先执行<code>apt-get update</code>,这个命令的作用是：同步 /etc/apt/sources.list 和 /etc/apt/sources.list.d 中列出的源的索引,这样才能获取到最新的软件包.</p>
<p>等更新完毕以后再敲命令:<code>apt-get install vim</code>命令即可.</p>
<p><strong><a href="http://dockone.io/article/103" target="_blank" rel="external">Dockerfile</a></strong><br>FROM 指令：指明当前镜像继承的基镜像。编译当前镜像时会自动下载基镜像</p>
<p>eg：<code>FROM unbuntu</code></p>
<p>MAINTAINER 指令：指明当前镜像的作者</p>
<p>eg：<code>MAINTAINER wyf</code></p>
<p>RUN 指令：可以在当前镜像上执行Linux命令并形成一个新的层。RUN是编译时的动作</p>
<p>eg：<code>RUN /bin/bash -c &quot;echo helloworld&quot;</code> 或 <code>RUN [&quot;/bin/bash&quot;, &quot;-c&quot;, &quot;echo hello&quot;]</code></p>
<p>CMD 指令：指明启动镜像容器时的默认行为。一个dockerFile只能有一个cmd指令。cmd指令里设定的命令可以在运行镜像时使用参数覆盖。CMD是运行run的动作</p>
<p>eg:<code>CMD echo &quot;this is a test&quot;</code></p>
<p>EXPOSE 指令：指定容器在运行时监听的端口</p>
<p>eg：<code>EXPOSE 8080</code></p>
<p>ENV 指令：用来设置环境变量</p>
<p>eg：<code>ENV myName=wyf</code> 或 <code>ENV myName wyf</code></p>
<p>ADD 指令：从当前工作目录复制文件到镜像目录中</p>
<p>eg:<code>ADD test.txt /mydir/</code></p>
<p>ENTRYPOINT 指令：配置给容器一个可执行的命令，这意味着在每次使用镜像创建容器时一个特定的应用程序可以被设置为默认程序。同时也意味着该镜像每次被调用时仅能运行指定的应用。类似于<code>CMD</code>，Docker只允许一个ENTRYPOINT，多个ENTRYPOINT会抵消之前所有的指令，只执行最后的ENTRYPOINT指令。</p>
<p>eg：<code>ENTRYPOINT [&quot;executable&quot;, &quot;param1&quot;,&quot;param2&quot;]</code><br><code>ENTRYPOINT command param1 param2</code></p>
<p>WORKDIR 指令：指定<code>RUN</code> <code>CMD</code> 与 <code>ENTRYPOINTT</code>命令的工作目录</p>
<p>eg：<code>WORKDIR /path/to/workdir</code></p>
<p>USER 指令：镜像正在运行时设置一个UID</p>
<p>eg: <code>USER 1241123123</code></p>
<p>VOLUME 指令：授权访问从容器内到主机上的目录</p>
<p>eg: <code>VOLUME [&quot;/data&quot;]</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"># 上传一个编译好的jar到centos</div><div class="line"># 在同级目录下面新建Dockerfile文件，内容如下：</div><div class="line"># 基镜像为java8</div><div class="line">FROM java:8</div><div class="line"># 设置作者</div><div class="line">MAINTAINER wyf</div><div class="line"># 将restful.jar添加到镜像中，重命名为restful.jar</div><div class="line">ADD restful.jar restful.jar</div><div class="line"># 运行镜像的容器，端口为8077</div><div class="line">EXPOSE 8077</div><div class="line"># 启动时运行 java -jar restful.jar</div><div class="line">ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/restful.jar&quot;]</div><div class="line"></div><div class="line"># 编译镜像 xxyxpy/restful 为镜像名称 .表示DockerFile的路径为当前目录</div><div class="line">docker build -t xxyxpy/restful .</div><div class="line"></div><div class="line"># 编译完成之后可以查看本地的镜像</div><div class="line">docker images</div><div class="line"></div><div class="line"># 运行编译完成的镜像 映射容器的8080端口（restful.jar的启动端口）到服务器的8077端口</div><div class="line">docker run -d --name restful -p 8077:8080 xxyxpy/restful</div><div class="line"></div><div class="line"># 此时可以通过服务器的ip:8077进行访问</div></pre></td></tr></table></figure>
<p><a href="http://www.runoob.com/docker/docker-install-mysql.html" target="_blank" rel="external">docker 安装 mysql</a></p>
<p><a href="https://itbilu.com/linux/docker/EyP7QP86M.html" target="_blank" rel="external">MySQL 官方Docker镜像的使用</a></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://xxyxpy.pub/2017/12/20/linux/docker/" data-id="cjblrl7au000rqwhqveb8xi8p" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-java/tool/java_other" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/12/15/java/tool/java_other/">java_other</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/12/15/java/tool/java_other/">
            <time datetime="2017-12-15T10:14:54.963Z" itemprop="datePublished">2017-12-15</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/java/">java</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/java/tool/">tool</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/java/">java</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h3 id="泛型中的T和？"><a href="#泛型中的T和？" class="headerlink" title="泛型中的T和？"></a>泛型中的T和？</h3><p><a href="http://www.jianshu.com/p/95f349258afb" target="_blank" rel="external">参考1</a>  <a href="https://www.ibm.com/developerworks/cn/java/j-jtp04298.html" target="_blank" rel="external">参考2</a></p>
<ul>
<li>T 表示具体的java类型，用于泛型的定义和使用</li>
<li>？表示不确定的java类型，一般只用于泛型的使用中。如：<code>List&lt;?&gt; myList = new ArrayList&lt;String&gt;();</code></li>
</ul>
<p>更详细的区别可以看下例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Generic</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">(List&lt;?&gt; list)</span> </span>&#123;</div><div class="line">        <span class="comment">// 返回Object类型</span></div><div class="line">        Object o = list.get(<span class="number">0</span>);</div><div class="line">        <span class="comment">// 无法add，因为无法确定？是什么类型，</span></div><div class="line">        <span class="comment">// 而此时添加的是Object，会违返类型约束</span></div><div class="line">        <span class="comment">//list.add(o);</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">test2</span><span class="params">(List&lt;T&gt; list)</span> </span>&#123;</div><div class="line">        <span class="comment">// 返回已知的T类型</span></div><div class="line">        T t = list.get(<span class="number">0</span>);</div><div class="line">        <span class="comment">// 添加成功</span></div><div class="line">        list.add(t);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        List&lt;String&gt; myList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        myList.add(<span class="string">"abc"</span>);</div><div class="line">        <span class="keyword">for</span> (String s : myList) &#123;</div><div class="line">            System.out.println(s);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Arrays-asList生成的List为什么不可以插入"><a href="#Arrays-asList生成的List为什么不可以插入" class="headerlink" title="Arrays.asList生成的List为什么不可以插入"></a>Arrays.asList生成的List为什么不可以插入</h3><p>先看一下效果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Integer[] ints = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</div><div class="line">List&lt;Integer&gt; asList = Arrays.asList(ints);</div><div class="line">asList.add(<span class="number">7</span>);</div><div class="line"><span class="comment">// 执行后异常</span></div><div class="line">Exception in thread <span class="string">"main"</span> java.lang.UnsupportedOperationException</div><div class="line">	at java.util.AbstractList.add(AbstractList.java:<span class="number">148</span>)</div><div class="line">	at java.util.AbstractList.add(AbstractList.java:<span class="number">108</span>)</div><div class="line">	at com.test.Generic.main(Generic.java:<span class="number">29</span>)</div></pre></td></tr></table></figure>
<p>分析下源码发现<code>Arrays</code>中的<code>ArrayList</code>是它自己的内部类继承自<code>AbstractList&lt;E&gt;</code>，并且只实现了部分方法，add方法并没有实现。所以使用时调用的时抽象父类的add方法该方法的定义直接拋出了异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>那如果真的有添加的需求要如何操作？需要自己定义一个非内部类的ArrayList，加入转换后的集合再进行添加操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Integer[] ints = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</div><div class="line">List&lt;Integer&gt; asList = Arrays.asList(ints);</div><div class="line"><span class="comment">//asList.add(7);</span></div><div class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">list.addAll(asList);</div><div class="line">list.add(<span class="number">7</span>);</div></pre></td></tr></table></figure>
<hr>
<p>Thread和Runnable的关系</p>
<ul>
<li>Thread为线程对象，在实例化时可以传入一个runnable接口的实现</li>
<li>两者应该算是父子关系，Thread实例的start方法调用的就是runnable接口中的run</li>
</ul>
<hr>
<p>线程池</p>
<ol>
<li><p>传统的创建线程存在的问题</p>
<ul>
<li>当需要线程的时候就需要进行初始化操作，性能差</li>
<li>可以无限制的创建线程，当存在循环创建时很容易出现线程爆增。线程越多占用内存越大，线程之间资源竟然越频繁，并且系统需要在线程之间进行上下文切换，最终可以死机或内存溢出</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Thread thread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"haha..."</span>);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>java提供的线程池功能</p>
<p>Java通过Executors类提供四种线程池。</p>
<ul>
<li><p><code>newCachedThreadPool</code>创建一个可缓存的线程池，通常用于处理时间较短的异步任务。如果60s内不使用则会被从缓存中清除掉。当无可用线程时会自动创建新线程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 线程池为无限大，当执行第二个任务时第一个任务已经完成，会复用执行第一个任务的线程，而不用每次新建线程</span></div><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cachedThreadPool</span><span class="params">()</span> </span>&#123;</div><div class="line">  ExecutorService cachedThreadPool = Executors.newCachedThreadPool();</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">int</span> index = i;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      Thread.sleep(index * <span class="number">1000</span>);</div><div class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">      e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">    cachedThreadPool.execute(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(index);</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><code>newFixedThreadPool</code>创建一个定长线程池，使用时如果无可用的线程则其它 的任务进入队列进行等待</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 高优先级线程</div><div class="line"> */</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MaxPriorityThreadFactory</span> <span class="keyword">implements</span> <span class="title">ThreadFactory</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> Thread <span class="title">newThread</span><span class="params">(Runnable r)</span> </span>&#123;</div><div class="line">        Thread t = <span class="keyword">new</span> Thread(r);</div><div class="line">        t.setPriority(Thread.MAX_PRIORITY);</div><div class="line">        <span class="keyword">return</span> t;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">fixedThreadPool</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">// 获取处理器核数</span></div><div class="line">  <span class="keyword">int</span> j = Runtime.getRuntime().availableProcessors();</div><div class="line">  ExecutorService fixedThreadPool = Executors.newFixedThreadPool(j, <span class="keyword">new</span> MaxPriorityThreadFactory());</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">int</span> index = i;</div><div class="line">    fixedThreadPool.execute(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">          System.out.println(index);</div><div class="line">          Thread.sleep(<span class="number">1000</span>);</div><div class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">          e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><code>newScheduledThreadPool</code>创建一个定长线程池，支持定时及周期性的任务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 定时</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">scheduledThreadPool1</span><span class="params">()</span> </span>&#123;</div><div class="line">  ScheduledExecutorService scheduledThreadPool = Executors.newScheduledThreadPool(<span class="number">4</span>);</div><div class="line">  <span class="comment">// 延迟3s执行</span></div><div class="line">  scheduledThreadPool.schedule(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">      System.out.println(<span class="string">"延迟3s执行"</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;, <span class="number">3</span>, TimeUnit.SECONDS);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 延迟1s后每3s执行一次，前一个任务开始执行就开始读秒</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">scheduledThreadPool2</span><span class="params">()</span> </span>&#123;</div><div class="line">  ScheduledExecutorService scheduledThreadPool = Executors.newScheduledThreadPool(<span class="number">4</span>);</div><div class="line">  <span class="comment">// 延迟3s执行</span></div><div class="line">  scheduledThreadPool.scheduleAtFixedRate(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">      System.out.println(<span class="string">"延迟1s执行,然后每3s执行一次"</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;, <span class="number">1</span>, <span class="number">3</span>, TimeUnit.SECONDS);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 延迟1s后每3s执行一次，前一个任务执行完成后开始读秒</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">scheduledThreadPool3</span><span class="params">()</span> </span>&#123;</div><div class="line">  ScheduledExecutorService scheduledThreadPool = Executors.newScheduledThreadPool(<span class="number">4</span>);</div><div class="line">  <span class="comment">// 延迟3s执行</span></div><div class="line">  scheduledThreadPool.scheduleWithFixedDelay(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">      System.out.println(<span class="string">"延迟1s执行,然后每3s执行一次"</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;, <span class="number">1</span>, <span class="number">3</span>, TimeUnit.SECONDS);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><code>newSingleThreadScheduledExecutor</code>创建一个单线程化的线程池</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 由于是单线程的线程池，任务会顺序执行</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">singleThreadPool</span><span class="params">()</span> </span>&#123;</div><div class="line">  ExecutorService singleThreadExecutor = Executors.newSingleThreadExecutor();</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">int</span> index = i;</div><div class="line">    singleThreadExecutor.execute(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">          System.out.println(index);</div><div class="line">          Thread.sleep(<span class="number">2000</span>);</div><div class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">          e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
</li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://xxyxpy.pub/2017/12/15/java/tool/java_other/" data-id="cjblrl7f2004pqwhqh0nh4nr6" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-java/spring/spring boot点滴" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/11/28/java/spring/spring boot点滴/">spring boot点滴</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/28/java/spring/spring boot点滴/">
            <time datetime="2017-11-28T09:24:59.869Z" itemprop="datePublished">2017-11-28</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/spring/">spring</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/spring-boot/">spring boot</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>1 banner操作</p>
<blockquote>
<p>在 src/main/resources 下新建 banner.txt</p>
<p>通过 <a href="http://patorjk.com/software/taag生成字符,拷贝进banner.txt" target="_blank" rel="external">http://patorjk.com/software/taag生成字符,拷贝进banner.txt</a></p>
<p>完成替换</p>
<p>关闭banner</p>
<p>SpringApplication app = new SpringApplication(xx.class);</p>
<p>app.setShowBanner(false);</p>
<p>app.run(args)</p>
</blockquote>
<p>2 加载外部配置文件</p>
<p>@PropertySource 注解不支持加载yaml文件,必须为property</p>
<p>3 加载外部的xml配置</p>
<p>@ImportResource 导入外部的xml配置</p>
<p>4 启动时修改端口号</p>
<blockquote>
<p>java -jar xx.jar –server.port=9090</p>
<p>运行时添加debug参数</p>
<p>java -jar xx.jar –debug</p>
</blockquote>
<p>5 类型安全的配置方式</p>
<blockquote>
<p>先定义一个实体</p>
<p>在配置中以特定的字符串开头，如book.xx</p>
<p>通过@ConfigurationProperties将属性和一个Bean的属性进行关联,从而实现类型安全的配置</p>
</blockquote>
<p>6 日志</p>
<blockquote>
<p>默认使用logback</p>
<p>配置日志文件 </p>
<p>logging.file=d:/mylog/log.log</p>
<p>配置日志级别,格式为logging.level.包名=级别</p>
<p>logging.level.org.springframework.web=DEBUG</p>
</blockquote>
<p>7 激活特定环境的配置</p>
<blockquote>
<p>配置文件名如：application-prod.properties application-dev.properties</p>
<p>激活：spring.profile.active=prod</p>
</blockquote>
<p>8 条件注解</p>
<blockquote>
<p>@ConditionalOnBean 当容器中有指定的Bean的条件下</p>
<p>@ConditionalOnClass 当类路径下有指定的类的条件下</p>
<p>@ConditionalOnExpression 基于SpEL表达式作为判断条件</p>
<p>@ConditionalOnJava 基于jvm版本作为判断条件</p>
<p>@ConditionalOnJndi 在Jndi存在的条件下查找指定的位置</p>
<p>@ConditionalOnMissingBean 当容器没有指定Bean的情况下</p>
<p>@ConditionalOnMissingClass 当类路径下没有指定类的条件下</p>
<p>@ConditionalOnNotWebApplication 当前项目不是web项目的条件下</p>
<p>@ConditionalOnProperty 指定的属性是否有指定的值</p>
<p>@ConditionalOnResource 类路径是否有指定的值</p>
<p>@ConditionalOnSingleCandidate 当指定Bean在容器中只有一个，或者虽然有多个但是指定首选的Bean</p>
<p>@ConditionalOnWebApplication 当前项目是web项目的条件下</p>
</blockquote>
<p>9 web中的静态资源</p>
<p>在WebMvcAutoConfiguration类的addResourceHandlers方法中定义了以下静态资源的自动配置</p>
<blockquote>
<p>类路径文件。把类路径下面的/static /public /resources 和 /META-INF/resources文件夹下面的静态文件直接映射为/**，可以通过<a href="http://localhost:8080/\*\*来访问" target="_blank" rel="external">http://localhost:8080/\*\*来访问</a></p>
<p>webjar.将常用的脚本框架封装在jar包中。把/META-INF/resources/webjars/下的静态文件映射为/webjar/<em>*,可以通过<a href="http://localhost:8080/webjar/\" target="_blank" rel="external">http://localhost:8080/webjar/\</a></em>*来访问</p>
</blockquote>
<p>10 自动配置HttpMessageConverters</p>
<p>在WebMvcAutoConfiguration中注解了messageConverters，在这里自动注入了非常多的messageConverter</p>
<p>如果需要新增自定义的转换器，可以直接自定义new HttpMessageConverters,把定义好的转换器添加进去</p>
<p>当然也可以定义配置类继承WebMvcConfigurerAdapter重写<em>configureMessageConverters</em>方法来add新的转换器进去</p>
<p>也可以继承WebMvcConfigurerAdapter重写<em>extendMessageConverters</em>方法，首先清空转换器列表，再加入自定义的转换器。</p>
<p>11 接管Spring Boot的Web配置</p>
<p>如果Spring Boot 提供的Mvc配置不符合要求，可以通过配置类加上<em>@EnableWebMvc</em>注解来实现完全自己控制的Mvc配置</p>
<p>如果既要保留原有的配置又想要添加或修改新的，可以自定义一个配置类并继承WebMvcConfigurerAdapter，无须使用<em>@EnableWebMvc</em>注解</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://xxyxpy.pub/2017/11/28/java/spring/spring boot点滴/" data-id="cjblrl7eh003mqwhqb66exeeg" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-java/spring/spring-注解" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/11/28/java/spring/spring-注解/">spring-注解</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/28/java/spring/spring-注解/">
            <time datetime="2017-11-28T02:06:41.140Z" itemprop="datePublished">2017-11-28</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/spring/">spring</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/annotaion/">annotaion</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>@Profile</p>
<p>指定环境名称，用于实现不同的环境的切换。比如数据库连接</p>
<p>@ActiveProfiles</p>
<p>声明活动的Profile</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestBean</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String content;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestBean</span><span class="params">(String content)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.content = content;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> content;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContent</span><span class="params">(String content)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.content = content;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 配置</span></div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestConfig</span> </span>&#123;</div><div class="line">    <span class="meta">@Bean</span></div><div class="line">    <span class="meta">@Profile</span>(<span class="string">"dev"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> TestBean <span class="title">devTestBean</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TestBean(<span class="string">"dev profile"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Bean</span></div><div class="line">    <span class="meta">@Profile</span>(<span class="string">"prod"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> TestBean <span class="title">prodTestBean</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TestBean(<span class="string">"prod profile"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 测试</span></div><div class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</div><div class="line"><span class="meta">@SpringBootTest</span></div><div class="line"><span class="meta">@ActiveProfiles</span>(<span class="string">"dev"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProfileTest</span> </span>&#123;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    <span class="keyword">private</span> TestBean testBean;</div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(testBean.getContent());<span class="comment">// 打印 dev profile</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>@EnableWebMvc 开启SpringMvc的支持</p>
<p>@ControllerAdvice 将对于控制器的全局配置放置在同一个位置，组合了@Component注解</p>
<p>@ExceptionHandler 用于全局处理控制器里的异常</p>
<p>@InitBinder 用来设置WeDataBinder，WeDataBinder用来自动绑定前台请求参数到Model中</p>
<p>@ModelAttribute 绑定键值对到Model里</p>
<p>配置</p>
<blockquote>
<p>@Value 加载单个配置项</p>
<p>@PropertySource 加载配置文件。不支持加载yaml文件,必须为property</p>
<p>@ImportResource 导入外部的xml配置</p>
<p>@ConfigurationProperties将配置和一个Bean的属性进行关联,从而实现类型安全的配置</p>
</blockquote>
<p>条件注解</p>
<blockquote>
<p>@ConditionalOnBean 当容器中有指定的Bean的条件下</p>
<p>@ConditionalOnClass 当类路径下有指定的类的条件下</p>
<p>@ConditionalOnExpression 基于SpEL表达式作为判断条件</p>
<p>@ConditionalOnJava 基于jvm版本作为判断条件</p>
<p>@ConditionalOnJndi 在Jndi存在的条件下查找指定的位置</p>
<p>@ConditionalOnMissingBean 当容器没有指定Bean的情况下</p>
<p>@ConditionalOnMissingClass 当类路径下没有指定类的条件下</p>
<p>@ConditionalOnNotWebApplication 当前项目不是web项目的条件下</p>
<p>@ConditionalOnProperty 指定的属性是否有指定的值</p>
<p>@ConditionalOnResource 类路径是否有指定的值</p>
<p>@ConditionalOnSingleCandidate 当指定Bean在容器中只有一个，或者虽然有多个但是指定首选的Bean</p>
<p>@ConditionalOnWebApplication 当前项目是web项目的条件下</p>
</blockquote>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://xxyxpy.pub/2017/11/28/java/spring/spring-注解/" data-id="cjblrl7et0046qwhql6xzexk6" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-linux/redis环境搭建" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/11/21/linux/redis环境搭建/">redis环境搭建</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/21/linux/redis环境搭建/">
            <time datetime="2017-11-21T03:28:04.838Z" itemprop="datePublished">2017-11-21</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/redis/">redis</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>redis编译时需要gcc环境，所以需要先安装gcc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install gcc gcc-c++</div></pre></td></tr></table></figure>
<h3 id="下载安装包"><a href="#下载安装包" class="headerlink" title="下载安装包"></a>下载安装包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget http://download.redis.io/releases/redis-3.2.5.tar.gz</div></pre></td></tr></table></figure>
<hr>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># 解压到/usr/local/目录下</div><div class="line">tar zxf redis-3.2.5.tar.gz -C /usr/local/</div><div class="line"># 进入解压后的目录</div><div class="line">cd /usr/local/redis-3.2.5</div><div class="line"># 安装到/usr/local/redis目录</div><div class="line">make PREFIX=/usr/local/redis install</div></pre></td></tr></table></figure>
<hr>
<h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 进入到redis下面的bin目录进行启动</div><div class="line">./redis-server</div></pre></td></tr></table></figure>
<p>此种启动方式为前端启动，即会独占一个连接窗口。一旦窗口关闭连接即中止。需要修改成后端模式启动</p>
<p>通过修改redis.conf配置文件的方式来实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># 拷贝源码目录下的redis.conf到安装目录bin下面</div><div class="line">cp /usr/local/redis-3.2.5/redis.conf /usr/local/redis/bin</div><div class="line"># 修改配置文件</div><div class="line">vim /usr/local/redis/bin/redis.conf</div><div class="line"># daemonize no 修改为 daemonize yes，此配置文件也可以修改启动的端口号。默认为6379</div><div class="line"># 后端启动</div><div class="line">./redis-server redis.conf</div><div class="line"># 查看启动是否成功</div><div class="line">ps aux|grep redis</div></pre></td></tr></table></figure>
<hr>
<h3 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># 通过bin目录下的redis-cli进行连接</div><div class="line"># 当前服务器</div><div class="line">./redis-cli</div><div class="line"># 指定ip默认6379端口</div><div class="line">./redis-cli -h 192.168.1.2</div><div class="line"># 指定ip和端口</div><div class="line">./redis-cli -h 192.168.1.2 -p 6380</div></pre></td></tr></table></figure>
<p>外部连接时会发现无法进行连接。因为考虑到安全的问题默认开启保护模式，仅允许127.0.0.1的ip进行连接。要修改的话需要修改<code>redis.conf</code></p>
<blockquote>
<p>修改bin</p>
<p>bin 0.0.0.0 表示允许所有的ip远程访问</p>
<p>修改protected-mode</p>
<p>protected-mode no</p>
</blockquote>
<p>修改完成之后再使用连接工具<code>RedisDesktopManager</code>尝试连接</p>
<hr>
<h3 id="停止"><a href="#停止" class="headerlink" title="停止"></a>停止</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./redis-cli shutdown</div></pre></td></tr></table></figure>
<hr>
<h3 id="集群版本"><a href="#集群版本" class="headerlink" title="集群版本"></a>集群版本</h3><p>redis集群中至少应该有三个节点。要保证集群的高可用，需要每个节点有一个备份机。</p>
<p>所以至少需要6台服务器，复制出来6个实例，设置端口号7001-7006</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"># 安装ruby</div><div class="line">yum install ruby</div><div class="line">yuminstall rubygems</div><div class="line"># 安装gem-redis 本机下载安装https://rubygems.org/gems/redis/versions/3.2.2</div><div class="line"># 下载完上传到centos</div><div class="line">gem install redis-3.2.2.gem</div><div class="line"># 新建集群目录</div><div class="line">cd /usr/local</div><div class="line">mkdir redis-cluster</div><div class="line"># 查看安装后的rb文件</div><div class="line">cd /usr/local/redis-3.2.5/src/</div><div class="line">ll *.rb</div><div class="line"># 复制到redis-cluster下面</div><div class="line">cp *.rb /usr/local/redis-cluster/</div><div class="line"># 复制单机版的实例到集群目录下面</div><div class="line">cd /usr/local/redis</div><div class="line">cp -r bin redis-cluster/redis01</div><div class="line"># 修改端口号 开启集群配置cluster-enabled去掉注释，值为yes</div><div class="line">vim redis-conf</div><div class="line"># 复制出来其它五个实例</div><div class="line">cp -r redis01 redis02</div><div class="line">......</div><div class="line"># 启动每一个实例，通过脚本批量启动</div><div class="line">vim start-all.sh</div><div class="line">cd redis01</div><div class="line">./redis-server redis.conf</div><div class="line">cd ..</div><div class="line">cd redis02</div><div class="line">./redis-server redis.conf</div><div class="line">cd ..</div><div class="line">cd redis03</div><div class="line">./redis-server redis.conf</div><div class="line">cd ..</div><div class="line">cd redis04</div><div class="line">./redis-server redis.conf</div><div class="line">cd ..</div><div class="line">cd redis05</div><div class="line">./redis-server redis.conf</div><div class="line">cd ..</div><div class="line">cd redis06</div><div class="line">./redis-server redis.conf</div><div class="line">cd ..</div><div class="line"># 添加执行权限</div><div class="line">chmod +x start-all.sh</div><div class="line"># 使用ruby脚本搭建集群，外部访问时需要开放端口号</div><div class="line"># --replicas 1：为集群中的每个主节点创建一个从节点</div><div class="line">./redis-trib.rb create --replicas 1 192.168.80.129:7001 192.168.80.129:7002 192.168.80.129:7003 192.168.80.129:7004 192.168.80.129:7005 192.168.80.129:7006</div><div class="line"># 此时有可能会报node is not empty的错误，需要删除节点目录下面的dump.rdb和nodes.conf</div><div class="line"># 这是单机版本节点的数据库文件，删除后重启启动执行即可</div><div class="line"></div><div class="line"># 连接集群，连接之后set一个key，切换一个集群端口去查看这个key</div><div class="line">redis01/redis-cli -p 7002 -c</div><div class="line">set abc 123</div><div class="line">redis01/redis-cli -p 7005 -c</div><div class="line">get abc</div><div class="line"></div><div class="line"># 关闭集群</div><div class="line">vim shutdown-all.sh</div><div class="line">./redis01/redis-cli -p 7001 shutdown</div><div class="line">./redis01/redis-cli -p 7002 shutdown</div><div class="line">./redis01/redis-cli -p 7003 shutdown</div><div class="line">./redis01/redis-cli -p 7004 shutdown</div><div class="line">./redis01/redis-cli -p 7005 shutdown</div><div class="line">./redis01/redis-cli -p 7006 shutdown</div><div class="line"># 添加权限</div><div class="line">chmod +x shutdown-all.sh</div></pre></td></tr></table></figure>
<p>参考：</p>
<p><a href="http://www.cnblogs.com/java-zhao/p/6134337.html" target="_blank" rel="external">redis集群搭建</a></p>
<p><a href="http://www.jianshu.com/p/338bc2a74300#" target="_blank" rel="external">redis集群搭建报node is not emtpy</a> </p>
<p><a href="http://blog.csdn.net/qq_39470733/article/details/77754695" target="_blank" rel="external">redis集群的搭建</a></p>
<p><a href="http://redisdoc.com/topic/cluster-tutorial.html" target="_blank" rel="external">redis命令参考-集群教程</a></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://xxyxpy.pub/2017/11/21/linux/redis环境搭建/" data-id="cjblrl7b20017qwhqka46asqq" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-ide/Intellij IDEA" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/11/09/ide/Intellij IDEA/">Intellij IDEA</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/09/ide/Intellij IDEA/">
            <time datetime="2017-11-09T08:58:56.785Z" itemprop="datePublished">2017-11-09</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/IDE/">IDE</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Intellij/">Intellij</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h3 id="设置-gt-keymap中有中文"><a href="#设置-gt-keymap中有中文" class="headerlink" title="设置-&gt;keymap中有中文"></a>设置-&gt;keymap中有中文</h3><p>偶然发现这篇博文<a href="http://blog.csdn.net/u013361445/article/details/51113692" target="_blank" rel="external">各种乱码解决方案</a>试了一下问题竟然解决了</p>
<img title="intellij01" alt="intellij01" src="http://oo0vldwkt.bkt.clouddn.com/static/images/ide\intellij01.png">
<p>需要修改idea64.exe.vmoptions文件，如果是用的32位的修改idea.exe.vmoptions。添加如下内容</p>
<blockquote>
<p>-Duser.country=EN</p>
<p>-Duser.language=us</p>
</blockquote>
<p>添加后重启idea，显示为英文。问题解决</p>
<hr>
<h3 id="spring-boot-devtools热部署无效"><a href="#spring-boot-devtools热部署无效" class="headerlink" title="spring-boot-devtools热部署无效"></a>spring-boot-devtools热部署无效</h3><ul>
<li>打开设置，compiler中的Build project automatically需要勾中</li>
<li>Shift+Ctrl+Alt+/，选择Registry。勾中compiler.automake.allow.when.app.running</li>
</ul>
<hr>
<h3 id="spring-boot远程调试"><a href="#spring-boot远程调试" class="headerlink" title="spring boot远程调试"></a>spring boot远程调试</h3><p>如果要进行远程调试必须要保证远程服务器端和本地的代码相同。</p>
<blockquote>
<p>// 在使用java指令启动程序时需要附加额外的参数以开启外部调试，如下<br>-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8888（自定义调试端口）</p>
<p>// 完整的启动指令是类似下面<br>java -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8888（自定义调试端口） -jar application.jar</p>
<p>在idea中编辑配置添加remote,输入远程的ip和端口号。然后启动debug模式</p>
</blockquote>
<hr>
<h3 id="tomcat-远程调试"><a href="#tomcat-远程调试" class="headerlink" title="tomcat 远程调试"></a>tomcat 远程调试</h3><p>关于前提条件和idea中的操作方式与上面的spring boot中调试一致，需要修改的就是服务端tomcat中的配置。</p>
<blockquote>
<p>在服务器Tomcat的bin目录下的catalina.sh中增加如下配置</p>
<p>// windows<br>set CATALINA_OPTS=”-agentlib:jdwp=transport=dt_socket,address=8888（自定义调试端口）,server=y,suspend=n %CATALINA_OPTS%”</p>
<p>// linux<br>export CATALINA_OPTS=”-agentlib:jdwp=transport=dt_socket,address= 8888（自定义调试端口）,server=y,suspend=n $CATALINA_OPTS”</p>
</blockquote>
<hr>
<h3 id="tomcat热部署"><a href="#tomcat热部署" class="headerlink" title="tomcat热部署"></a>tomcat热部署</h3><p>使用maven实现tomcat热部署</p>
<ul>
<li><p>修改tomcat的conf/tomcat-users.xml配置文件。添加用户名、密码、权限，配置完成之后需要重启tomcat</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-gui"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-script"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">username</span>=<span class="string">"tomcat"</span> <span class="attr">password</span>=<span class="string">"tomcat"</span> <span class="attr">roles</span>=<span class="string">"manager-gui, manager-script"</span>/&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>配置tomcat插件，需要修改pom.xml文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 配置Tomcat插件 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">port</span>&gt;</span>8081<span class="tag">&lt;/<span class="name">port</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- / 为webapps下面的root目录 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">path</span>&gt;</span>/<span class="tag">&lt;/<span class="name">path</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- tomcat服务地址 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://192.168.25.135:8080/manager/text<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">username</span>&gt;</span>tomcat<span class="tag">&lt;/<span class="name">username</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">password</span>&gt;</span>tomcat<span class="tag">&lt;/<span class="name">password</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span>		</div><div class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>使用maven命令部署</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 首次部署，目录为空时</div><div class="line">tomcat7:deploy</div><div class="line"># 重新部署，目录不为空</div><div class="line">tomcat7:redeploy</div></pre></td></tr></table></figure>
<img title="tags" alt="tags" src="http://oo0vldwkt.bkt.clouddn.com/static/images/ide\idea1.jpg"></li>
</ul>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://xxyxpy.pub/2017/11/09/ide/Intellij IDEA/" data-id="cjblrl7ar000mqwhqa53xzt4i" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-linux/jdk mysql tomcat环境搭建" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/11/07/linux/jdk mysql tomcat环境搭建/">jdk mysql环境搭建</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/07/linux/jdk mysql tomcat环境搭建/">
            <time datetime="2017-11-07T02:45:59.710Z" itemprop="datePublished">2017-11-07</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/jdk/">jdk</a>, <a class="tag-link" href="/tags/linux/">linux</a>, <a class="tag-link" href="/tags/mysql/">mysql</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>jdk</p>
<p>a 卸载原来的openjdk</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rpm -qa |grep java</div><div class="line"># 如果有openjdk相关的包，全部删除掉。使用如下的命令</div><div class="line">rpm -e --nodeps 具体的包名</div></pre></td></tr></table></figure>
<p>b 解压jdk到指定的目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd /usr/local</div><div class="line">mkdir java</div><div class="line">tar -zxf jdk1.8.0_131.tar.gz</div></pre></td></tr></table></figure>
<p>c 设置环境变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">vim /etc/profile</div><div class="line"># 添加如下的信息</div><div class="line"></div><div class="line"># set java environment</div><div class="line">export JAVA_HOME=/usr/local/java/jdk1.8.0_131</div><div class="line">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre</div><div class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib</div><div class="line">export PATH=$&#123;JAVA_HOME&#125;/bin:$&#123;PATH&#125;</div><div class="line"></div><div class="line"># 刷新配置</div><div class="line">source /etc/profile</div><div class="line"></div><div class="line"># 查看java版本</div><div class="line">java -version</div></pre></td></tr></table></figure>
<hr>
<p>mysql</p>
<p><a href="https://www.cnblogs.com/starof/p/4680083.html" target="_blank" rel="external">https://www.cnblogs.com/starof/p/4680083.html</a></p>
<p>a 卸载自带的mysql</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rpm -qa |grep mysql</div><div class="line"># 如果有mysql相关的包，全部删除掉。使用如下的命令</div><div class="line">rpm -e --nodeps 具体的包名</div></pre></td></tr></table></figure>
<p>b 解压mysql到指定的目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd /usr/local</div><div class="line">mkdir mysql</div><div class="line">tar -xvf MySQL-5.6.22-1.el6.i686.rpm-bundle.tar -C /usr/local/mysql</div></pre></td></tr></table></figure>
<p>c 安装依赖项</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum -y install libaio.so.1 libgcc_s.so.1 libstdc++.so.6</div><div class="line">yum  update libstdc++-4.4.7-4.el6.x86_64</div></pre></td></tr></table></figure>
<p>d 安装服务端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rpm -ivh MySQL-server-5.6.22-1.el6.i686.rpm</div></pre></td></tr></table></figure>
<p>e 安装客户端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rpm -ivh MySQL-client-5.6.22-1.el6.i686.rpm</div></pre></td></tr></table></figure>
<p>f 启动mysql服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">service mysql status</div><div class="line">service mysql start</div></pre></td></tr></table></figure>
<p>g 登录</p>
<p>服务启动时生成了一个随机密码在<code>/root/.mysql_secret</code>可以进行修改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">msyql –u root -p</div><div class="line"># 登录成功之后修改密码</div><div class="line">mysql&gt; use mysql;</div><div class="line">mysql&gt; UPDATE user SET Password = PASSWORD(&apos;newpass&apos;) WHERE user = &apos;root&apos;;</div><div class="line">mysql&gt; FLUSH PRIVILEGES;</div></pre></td></tr></table></figure>
<p>h 设置开机自启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 加入到系统服务：</div><div class="line">chkconfig --add mysql</div><div class="line"># 自动启动：</div><div class="line">chkconfig mysql on</div></pre></td></tr></table></figure>
<p>i 开启远程服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># 默认root是不支持远程登录的</div><div class="line">grant all privileges on *.* to &apos;root&apos; @&apos;%&apos; identified by &apos;123456&apos;;</div><div class="line">flush privileges;</div></pre></td></tr></table></figure>
<p>j 设置防火墙</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># 设置对3306端口进行放行，否则本机外无法进行连接</div><div class="line">/sbin/iptables -I INPUT -p tcp --dport 3306 -j ACCEPT</div><div class="line">/etc/rc.d/init.d/iptables save</div><div class="line">/etc/rc.d/init.d/iptables restart #重启服务 </div><div class="line"># 查看端口是否已经开放 </div><div class="line">/etc/init.d/iptables status</div></pre></td></tr></table></figure>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://xxyxpy.pub/2017/11/07/linux/jdk mysql tomcat环境搭建/" data-id="cjblrl7ax000wqwhqcqegy6x2" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <article id="post-linux/rabbitmq环境搭建" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/11/03/linux/rabbitmq环境搭建/">rabbitmq环境搭建</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/11/03/linux/rabbitmq环境搭建/">
            <time datetime="2017-11-03T01:43:30.594Z" itemprop="datePublished">2017-11-03</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/rabbitmq/">rabbitmq</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"># 首先需要安装erlang环境</div><div class="line"># 在线安装，在线安装较慢也可以下载下来手动安装</div><div class="line">rpm -Uvh http://www.rabbitmq.com/releases/erlang/erlang-19.0.4-1.el7.centos.x86_64.rpm</div><div class="line"># 手动安装</div><div class="line">rpm -i  erlang-19.0.4-1.el7.centos.x86_64.rpm</div><div class="line"># 查看安装是否成功</div><div class="line">rpm -qa|grep erlang</div><div class="line"></div><div class="line"># 安装rabbitmq</div><div class="line">rpm -Uvh http://www.rabbitmq.com/releases/rabbitmq-server/v3.6.12/rabbitmq-server-3.6.12-1.el7.noarch.rpm</div><div class="line"># 提示需要socat，安装一下后重新安装rabbitmq</div><div class="line">yun install socat</div><div class="line"># 手动安装rabbitmq</div><div class="line">rpm -i  rabbitmq-server-3.6.12-1.el7.noarch.rpm </div><div class="line">rpm -qa|grep rabbitmq</div></pre></td></tr></table></figure>
<hr>
<h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 开启</div><div class="line">service rabbitmq-server start</div><div class="line"># 关闭</div><div class="line">service rabbitmq-server stop</div><div class="line"># 查看状态</div><div class="line">rabbitmqctl status</div><div class="line"># 重启</div><div class="line">service rabbitmq-server restart</div></pre></td></tr></table></figure>
<hr>
<h3 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h3><p>默认在15672端口上开启web访问服务，直接访问时无法连接。需要安装维护插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rabbitmq-plugins enable rabbitmq_management</div><div class="line"># reboot</div><div class="line">service rabbitmq-server restart</div></pre></td></tr></table></figure>
<p>再次打开<code>http://192.168.80.129:15672</code>即可打开登录界面，用户名和密码都是guest</p>
<hr>
<h3 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h3><p>直接用guest是无法完成登录的，<a href="http://www.rabbitmq.com/access-control.html" target="_blank" rel="external">官网</a>介绍的是默认不允许guest在非localhost的机器上面登录。需要修改配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">vim /etc/rabbitmq/rabbitmq.config</div><div class="line"># 添加如下内容，注意最后一个.是必须的</div><div class="line">[&#123;rabbit, [&#123;loopback_users, []&#125;]&#125;].</div><div class="line"># reboot 即可访问登录</div><div class="line">service rabbitmq-server restart</div></pre></td></tr></table></figure>
<hr>
<h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h3><p>在集成spring boot时报<code>Failed to declare queue</code>，原因是没有这个queue，需要在管理页面添加这个queue。</p>
<p>另外如果要启用新的用户，也可以在管理界面进行添加</p>
<p>参考：</p>
<p><a href="http://blog.csdn.net/zheng911209/article/details/49945677" target="_blank" rel="external">centos7安装rabbitmq</a></p>
<p><a href="http://blog.csdn.net/a286352250/article/details/53158667" target="_blank" rel="external">spring boot 集成rabbitmq</a></p>
<p><a href="http://blog.didispace.com/spring-boot-rabbitmq/" target="_blank" rel="external">spring boot中使用rabbitmq</a></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://xxyxpy.pub/2017/11/03/linux/rabbitmq环境搭建/" data-id="cjblrl7b00013qwhq23vhgck4" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
</article>



    <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
    </nav>
</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/12/25/linux/vps相关/" class="thumbnail">
    
    
        <span style="background-image:url(http://swiftlet.net/wp-content/uploads/2017/04/20170416204714_50373.jpg)" alt="vps相关" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/linux/">linux</a></p>
                            <p class="item-title"><a href="/2017/12/25/linux/vps相关/" class="title">vps相关</a></p>
                            <p class="item-date"><time datetime="2017-12-25T05:31:12.282Z" itemprop="datePublished">2017-12-25</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/12/21/linux/linux/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/linux/">linux</a></p>
                            <p class="item-title"><a href="/2017/12/21/linux/linux/" class="title">linux</a></p>
                            <p class="item-date"><time datetime="2017-12-21T01:22:22.788Z" itemprop="datePublished">2017-12-21</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/12/20/linux/docker/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/linux/">linux</a></p>
                            <p class="item-title"><a href="/2017/12/20/linux/docker/" class="title">docker</a></p>
                            <p class="item-date"><time datetime="2017-12-20T01:59:03.718Z" itemprop="datePublished">2017-12-20</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/12/15/java/tool/java_other/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/java/">java</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/java/tool/">tool</a></p>
                            <p class="item-title"><a href="/2017/12/15/java/tool/java_other/" class="title">java_other</a></p>
                            <p class="item-date"><time datetime="2017-12-15T10:14:54.963Z" itemprop="datePublished">2017-12-15</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/11/28/java/spring/spring boot点滴/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/spring/">spring</a></p>
                            <p class="item-title"><a href="/2017/11/28/java/spring/spring boot点滴/" class="title">spring boot点滴</a></p>
                            <p class="item-date"><time datetime="2017-11-28T09:24:59.869Z" itemprop="datePublished">2017-11-28</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/">IDE</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/c/">c#</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">28</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/jdbc/">jdbc</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/ssh/">ssh</a><span class="category-list-count">14</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/ssh/hibernate/">hibernate</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/ssh/spring/">spring</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/ssh/struts2/">struts2</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/tool/">tool</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/web/">web</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/web/servlet/">servlet</a><span class="category-list-count">1</span></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/myBlog/">myBlog</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nosql/">nosql</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring/">spring</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构和算法/">数据结构和算法</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/激活码/">激活码</a><span class="category-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">2</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Intellij/">Intellij</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/activemq/">activemq</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/annotaion/">annotaion</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ashx/">ashx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cookie/">cookie</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/el/">el</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/filter/">filter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hiberante/">hiberante</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/io/">io</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">28</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdbc/">jdbc</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdk/">jdk</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jsp/">jsp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jstl/">jstl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/listener/">listener</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mail/">mail</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nexT/">nexT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rabbitmq/">rabbitmq</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/request/">request</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/response/">response</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/session/">session</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/solr/">solr</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-boot/">spring boot</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlserver/">sqlserver</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/struts2/">struts2</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vps/">vps</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/事务/">事务</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/回文数/">回文数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/套路/">套路</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/泛型/">泛型</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/激活码/">激活码</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/Intellij/" style="font-size: 10px;">Intellij</a> <a href="/tags/activemq/" style="font-size: 10px;">activemq</a> <a href="/tags/annotaion/" style="font-size: 10px;">annotaion</a> <a href="/tags/ashx/" style="font-size: 10px;">ashx</a> <a href="/tags/cookie/" style="font-size: 10px;">cookie</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/el/" style="font-size: 10px;">el</a> <a href="/tags/filter/" style="font-size: 10px;">filter</a> <a href="/tags/hexo/" style="font-size: 12px;">hexo</a> <a href="/tags/hiberante/" style="font-size: 18px;">hiberante</a> <a href="/tags/io/" style="font-size: 10px;">io</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/jdbc/" style="font-size: 14px;">jdbc</a> <a href="/tags/jdk/" style="font-size: 10px;">jdk</a> <a href="/tags/jsp/" style="font-size: 10px;">jsp</a> <a href="/tags/jstl/" style="font-size: 10px;">jstl</a> <a href="/tags/linux/" style="font-size: 16px;">linux</a> <a href="/tags/listener/" style="font-size: 10px;">listener</a> <a href="/tags/mail/" style="font-size: 10px;">mail</a> <a href="/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nexT/" style="font-size: 10px;">nexT</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/rabbitmq/" style="font-size: 10px;">rabbitmq</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/request/" style="font-size: 10px;">request</a> <a href="/tags/response/" style="font-size: 10px;">response</a> <a href="/tags/session/" style="font-size: 10px;">session</a> <a href="/tags/solr/" style="font-size: 10px;">solr</a> <a href="/tags/spring/" style="font-size: 14px;">spring</a> <a href="/tags/spring-boot/" style="font-size: 10px;">spring boot</a> <a href="/tags/sqlserver/" style="font-size: 10px;">sqlserver</a> <a href="/tags/struts2/" style="font-size: 14px;">struts2</a> <a href="/tags/vps/" style="font-size: 10px;">vps</a> <a href="/tags/web/" style="font-size: 16px;">web</a> <a href="/tags/事务/" style="font-size: 10px;">事务</a> <a href="/tags/回文数/" style="font-size: 10px;">回文数</a> <a href="/tags/套路/" style="font-size: 12px;">套路</a> <a href="/tags/泛型/" style="font-size: 10px;">泛型</a> <a href="/tags/激活码/" style="font-size: 10px;">激活码</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2017 xxyxpy<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        


    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>